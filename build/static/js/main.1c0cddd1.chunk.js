(this.webpackJsonphtmlui=this.webpackJsonphtmlui||[]).push([[0],{133:function(e,t,s){},147:function(e,t,s){},148:function(e,t,s){"use strict";s.r(t);var n=s(1),i=s.n(n),a=s(48),r=s.n(a),o=s(17),c=s(14),l=s.n(c),h=(s(132),s(108)),d=s(109),u=s(76),j=s(25),p=s(26),b=(s(133),s(10)),O=s(11),m=s(7),v=s(13),f=s(12),x=s(15),g=s(4),y=s(3),k=s(9),S=s(38),w=s(2),C=s(62);function D(e,t,s){for(var n=Object(w.a)({},e.state),i=n,a=t.split(/\./),r=0;r<a.length-1;r++){var o=a[r];void 0===i[o]?i[o]={}:i[o]=Object(w.a)({},i[o]),i=i[o]}i[a[a.length-1]]=s,e.setState(n)}function L(e,t){for(var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=e.state,i=t.split(/\./),a=0;a<i.length;a++){var r=i[a];if(!(r in n))return s;n=n[r]}return n}var F=s(0);function P(e,t){for(var s={},n=!1,i=0;i<t.length;i++){var a=t[i];e.state[a]||(s[a]="",n=!0)}return!n||(e.setState(s),!1)}function N(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e.value};D(this,e.target.name,t(e.target))}function I(e,t){return L(e,t)}function T(e,t,s){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return Object(F.jsxs)(g.a.Group,{as:k.a,children:[Object(F.jsx)(g.a.Label,{className:"required",children:t}),Object(F.jsx)(g.a.Control,Object(w.a)({size:"sm",isInvalid:""===I(e,s,null),name:s,value:I(e,s),"data-testid":"control-"+s,onChange:e.handleChange},n)),i&&Object(F.jsx)(g.a.Text,{className:"text-muted",children:i}),Object(F.jsxs)(g.a.Control.Feedback,{type:"invalid",children:[t," Is Required"]})]})}function R(e,t,s){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;return Object(F.jsxs)(g.a.Group,{as:k.a,children:[Object(F.jsx)(g.a.Label,{children:t}),Object(F.jsx)(g.a.Control,Object(w.a)({size:"sm",name:s,value:I(e,s),"data-testid":"control-"+s,onChange:e.handleChange},n)),i&&Object(F.jsx)(g.a.Text,{className:"text-muted",children:i}),a&&Object(F.jsx)(g.a.Control.Feedback,{type:"invalid",children:a})]})}function H(e){if(""!==e.value){var t=Number.parseInt(e.value);return isNaN(t)?e.value+"":t}}function E(e){return void 0!==e&&""!==e&&!!isNaN(Number.parseInt(e))}function z(e,t,s){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Object(F.jsxs)(g.a.Group,{as:k.a,children:[t&&Object(F.jsx)(g.a.Label,{children:t}),Object(F.jsx)(g.a.Control,Object(w.a)({size:"sm",name:s,isInvalid:E(I(e,s)),value:I(e,s),onChange:function(t){return e.handleChange(t,H)},"data-testid":"control-"+s},n)),Object(F.jsx)(g.a.Control.Feedback,{type:"invalid",children:"Must be a valid number or empty"})]})}function A(e,t,s){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Object(F.jsxs)(g.a.Group,{as:k.a,children:[Object(F.jsx)(g.a.Label,{children:t}),Object(F.jsx)(g.a.Control,Object(w.a)({size:"sm",name:s,isInvalid:""===I(e,s,null)||E(I(e,s)),value:I(e,s),onChange:function(t){return e.handleChange(t,H)},"data-testid":"control-"+s},n)),Object(F.jsx)(g.a.Control.Feedback,{type:"invalid",children:"Must be a valid number or empty"})]})}function U(e,t){for(var s=0,n=0;n<t.length;n++)I(e,t[n])&&s++;return 1===s}function B(e){return!!e.checked}function G(e,t,s,n){return Object(F.jsxs)(g.a.Group,{as:k.a,children:[Object(F.jsx)(g.a.Check,{label:t,name:s,className:"required",checked:I(e,s),onChange:function(t){return e.handleChange(t,B)},"data-testid":"control-"+s,type:"checkbox"}),n&&Object(F.jsx)(g.a.Text,{className:"text-muted",children:n})]})}function M(e){return"true"===e.value||"false"!==e.value&&void 0}function W(e,t,s,n){return Object(F.jsxs)(g.a.Group,{as:k.a,children:[t&&Object(F.jsx)(g.a.Label,{children:t}),Object(F.jsxs)(g.a.Control,{size:"sm",name:s,value:I(e,s),onChange:function(t){return e.handleChange(t,M)},as:"select",children:[Object(F.jsx)("option",{value:"",children:n}),Object(F.jsx)("option",{value:"true",children:"yes"}),Object(F.jsx)("option",{value:"false",children:"no"})]})]})}function K(e){var t=e.value;if(""!==t)return t.split(/\n/)}function V(e,t){return Object(F.jsx)(g.a.Group,{as:k.a,children:Object(F.jsx)(g.a.Control,{size:"sm",name:t,value:(s=I(e,t),s?s.join("\n"):""),onChange:function(t){return e.handleChange(t,K)},as:"textarea",rows:"5"})});var s}function q(e,t){function s(e){var t=/(\d+):(\d+)/.exec(e);if(t){var s=parseInt(t[1]),n=parseInt(t[2]),i=s<24&&n<60;if(n<10&&1===t[2].length&&(i=!1),i)return{hour:s,min:n}}return e}function n(e){var t=e.value;if(""!==t){var n,i=[],a=Object(S.a)(t.split(/\n/));try{for(a.s();!(n=a.n()).done;){var r=n.value;i.push(s(r))}}catch(o){a.e(o)}finally{a.f()}return i}}return Object(F.jsxs)(C.a,{children:[Object(F.jsx)(g.a.Control,{size:"sm",name:t,value:function(e){if(e){var t,s=[],n=Object(S.a)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.hour?s.push(i.hour+":"+(i.min<10?"0":"")+i.min):s.push(i)}}catch(a){n.e(a)}finally{n.f()}return s.join("\n")}return""}(I(e,t)),onChange:function(t){return e.handleChange(t,n)},as:"textarea",rows:"5"}),Object(F.jsx)(g.a.Control.Feedback,{type:"invalid",children:"Invalid Times of Day"})]})}function _(e,t){return Object(F.jsxs)(g.a.Control,{as:"select",size:"sm",name:t,onChange:function(t){return e.handleChange(t,H)},value:I(e,t),children:[Object(F.jsx)("option",{value:"",children:"(inherit from parent)"}),Object(F.jsx)("option",{value:"0",children:"0 - no output"}),Object(F.jsx)("option",{value:"1",children:"1 - minimal details"}),Object(F.jsx)("option",{value:"2",children:"2"}),Object(F.jsx)("option",{value:"3",children:"3"}),Object(F.jsx)("option",{value:"4",children:"4"}),Object(F.jsx)("option",{value:"5",children:"5 - normal details"}),Object(F.jsx)("option",{value:"6",children:"6"}),Object(F.jsx)("option",{value:"7",children:"7"}),Object(F.jsx)("option",{value:"8",children:"8"}),Object(F.jsx)("option",{value:"9",children:"9"}),Object(F.jsx)("option",{value:"10",children:"10 - maximum details"})]})}var J=s(5),Z=s(19),Y=s(18),Q=s(70),X=s(71),$=s(24),ee=["onDirectorySelected"],te=["","K","M","G","T"];function se(e){return Math.round(10*e)/10+""}function ne(e,t){if(void 0===e)return"";if(!t||!t.errors||!t.numFailed)return Object(F.jsx)("span",{children:ie(e)});var s="Encountered "+t.numFailed+" errors:\n\n",n="- ";return 1===t.numFailed&&(s="Error: ",n=""),s+=t.errors.map((function(e){return n+e.path+": "+e.error})).join("\n"),Object(F.jsxs)("span",{children:[ie(e),"\xa0",Object(F.jsx)(Y.a,{color:"red",icon:Z.l,title:s})]})}function ie(e){return void 0===e?"":function(e,t,s,n){for(var i=0;i<s.length;i++){if(e<.9*t)return se(e)+" "+s[i]+n;e/=t}return se(e)+" "+s[s.length-1]+n}(e,1e3,te,"B")}function ae(e){for(var t={},s=("?"===e[0]?e.substr(1):e).split("&"),n=0;n<s.length;n++){var i=s[n].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]||"")}return t}function re(e){return e?new Date(e).toLocaleString():""}function oe(e){return e.startsWith("k")?"/snapshots/dir/"+e:"/api/v1/objects/"+e}function ce(e){return e.userName+"@"+e.host}function le(e,t){return e<t?-1:e>t?1:0}function he(e){e&&e.response&&e.response.data&&"NOT_CONNECTED"===e.response.data.code&&window.location.replace("/repo")}function de(e){return Math.round(e/100)/10+"s"}function ue(e,t){if(!e)return"";if(!t){var s=(new Date).valueOf()-new Date(e).valueOf();return s<0?"":de(s)}return de(new Date(t).valueOf()-new Date(e).valueOf())}function je(e){l.a.post("/api/v1/tasks/"+e+"/cancel",{}).then((function(e){})).catch((function(e){}))}function pe(e){return Object(F.jsxs)(x.a,Object(w.a)(Object(w.a)({size:"sm",variant:"outline-secondary"},e),{},{children:[Object(F.jsx)(Y.a,{icon:Z.h})," Return "]}))}function be(e){return e.host||e.userName?e.userName?e.path?"Directory: "+e.userName+"@"+e.host+":"+e.path:"User: "+e.userName+"@"+e.host:"Host: "+e.host:"Global Policy"}function Oe(e){return"/policies/edit?"+me(e)}function me(e){return"userName="+encodeURIComponent(e.userName)+"&host="+encodeURIComponent(e.host)+"&path="+encodeURIComponent(e.path)}function ve(e,t){t||(t="Error"),t+=": ",e.response&&e.response.data&&e.response.data.error?alert(t+e.response.data.error):e instanceof Error?alert(e):alert(t+JSON.stringify(e))}function fe(e){var t=e.onDirectorySelected,s=Object(J.a)(e,ee);return window.kopiaUI?Object(F.jsxs)(X.a,{children:[Object(F.jsx)(Q.a,Object(w.a)({size:"sm"},s)),Object(F.jsx)(x.a,{size:"sm",onClick:function(){return window.kopiaUI.selectDirectory(t)},children:Object(F.jsx)(Y.a,{icon:Z.o})})]}):Object(F.jsx)(g.a.Control,Object(w.a)({size:"sm"},s))}function xe(e){var t=Object(n.useState)(!1),s=Object(o.a)(t,2),a=s[0],r=s[1],c=Object(n.useState)({}),h=Object(o.a)(c,2),d=h[0],u=h[1];a&&!d.executable&&l.a.get("/api/v1/cli").then((function(e){u(e.data)})).catch((function(e){}));var j=i.a.createRef();return Object(F.jsx)(F.Fragment,{children:Object(F.jsxs)(X.a,{size:"sm",children:[Object(F.jsx)(x.a,{size:"sm",title:"Click to show CLI equivalent",variant:"warning",onClick:function(){return r(!a)},children:Object(F.jsx)(Y.a,{size:"sm",icon:Z.t})}),a&&Object(F.jsx)(x.a,{class:"sm",variant:"outline-dark",title:"Copy to clipboard",onClick:function(){var e=j.current;e&&(e.select(),e.setSelectionRange(0,99999),document.execCommand("copy"))},children:Object(F.jsx)(Y.a,{size:"sm",icon:Z.j})}),a&&Object(F.jsx)(Q.a,{size:"sm",ref:j,className:"cli-equivalent",value:"".concat(d.executable," ").concat(e.command)})]})})}var ge=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this)).state={incremental:!0,continueOnErrors:!1,restoreOwnership:!0,restorePermissions:!0,restoreModTimes:!0,uncompressedZip:!0,overwriteFiles:!1,overwriteDirectories:!1,overwriteSymlinks:!1,ignorePermissionErrors:!0,writeFilesAtomically:!1,restoreDirEntryAtDepth:1e3,minSizeForPlaceholder:0,restoreTask:""},n.handleChange=N.bind(Object(m.a)(n)),n.start=n.start.bind(Object(m.a)(n)),n}return Object(O.a)(s,[{key:"start",value:function(e){var t=this;if(e.preventDefault(),P(this,["destination"])){var s=this.state.destination+"",n={root:this.props.match.params.oid,options:{incremental:this.state.incremental,ignoreErrors:this.state.continueOnErrors,restoreDirEntryAtDepth:this.state.restoreDirEntryAtDepth,minSizeForPlaceholder:this.state.minSizeForPlaceholder}};s.endsWith(".zip")?(n.zipFile=s,n.uncompressedZip=this.state.uncompressedZip):s.endsWith(".tar")?n.tarFile=s:n.fsOutput={targetPath:s,skipOwners:!this.state.restoreOwnership,skipPermissions:!this.state.restorePermissions,skipTimes:!this.state.restoreModTimes,ignorePermissionErrors:this.state.ignorePermissionErrors,overwriteFiles:this.state.overwriteFiles,overwriteDirectories:this.state.overwriteDirectories,overwriteSymlinks:this.state.overwriteSymlinks,writeFilesAtomically:this.state.writeFilesAtomically},l.a.post("/api/v1/restore",n).then((function(e){t.setState({restoreTask:e.data.id}),t.props.history.replace("/tasks/"+e.data.id)})).catch((function(e){ve(e)}))}}},{key:"render",value:function(){return this.state.restoreTask?Object(F.jsxs)("p",{children:[Object(F.jsx)(pe,{onClick:this.props.history.goBack}),Object(F.jsx)(j.b,{replace:"true",to:"/tasks/"+this.state.restoreTask,children:"Go To Restore Task"}),"."]}):Object(F.jsxs)("div",{className:"padded-top",children:[Object(F.jsx)(pe,{onClick:this.props.history.goBack}),"\xa0",Object(F.jsx)("span",{className:"page-title",children:"Restore"}),Object(F.jsx)("hr",{}),Object(F.jsxs)(g.a,{onSubmit:this.start,children:[Object(F.jsx)(y.a,{children:T(this,"Destination","destination",{autoFocus:!0,placeholder:"enter destination path"},"You can also restore to a .zip or .tar file by providing the appropriate extension.")}),Object(F.jsx)(y.a,{children:G(this,"Skip previously restored files and symlinks","incremental")}),Object(F.jsx)(y.a,{children:G(this,"Continue on Errors","continueOnErrors","When a restore error occurs, attempt to continue instead of failing fast.")}),Object(F.jsx)(y.a,{children:G(this,"Restore File Ownership","restoreOwnership")}),Object(F.jsx)(y.a,{children:G(this,"Restore File Permissions","restorePermissions")}),Object(F.jsx)(y.a,{children:G(this,"Restore File Modification Time","restoreModTimes")}),Object(F.jsx)(y.a,{children:G(this,"Overwrite Files","overwriteFiles")}),Object(F.jsx)(y.a,{children:G(this,"Overwrite Directories","overwriteDirectories")}),Object(F.jsx)(y.a,{children:G(this,"Overwrite Symbolic Links","overwriteSymlinks")}),Object(F.jsx)(y.a,{children:G(this,"Write files atomically","writeFilesAtomically")}),Object(F.jsx)(y.a,{children:Object(F.jsx)(k.a,{children:Object(F.jsx)("hr",{})})}),Object(F.jsxs)(y.a,{children:[A(this,"Shallow Restore At Depth","restoreDirEntryAtDepth"),A(this,"Minimal File Size For Shallow Restore","minSizeForPlaceholder")]}),Object(F.jsx)(y.a,{children:Object(F.jsx)(k.a,{children:Object(F.jsx)("hr",{})})}),Object(F.jsx)(y.a,{children:G(this,"Disable ZIP compression","uncompressedZip","Do not compress when restoring to a ZIP file (faster).")}),Object(F.jsx)(y.a,{children:Object(F.jsx)(k.a,{children:Object(F.jsx)("hr",{})})}),Object(F.jsx)(y.a,{children:Object(F.jsx)(k.a,{children:Object(F.jsx)(x.a,{variant:"primary",type:"submit","data-testid":"submit-button",children:"Begin Restore"})})})]})]})}}]),s}(n.Component),ye=s(49),ke=s(83),Se=s(90);function we(e,t,s){var n=[];function i(e){return Object(F.jsx)(ye.a.Item,{active:e===t,onClick:function(){return s(e-1)},children:e},e)}function a(){return Object(F.jsx)(ye.a.Ellipsis,{})}var r=t-10;r<1&&(r=1);var o=t+9;r+19>=o&&(o=r+19),o>e&&(o=e),r>1&&n.push(a());for(var c=r;c<=o;c++)n.push(i(c));return o<e&&n.push(a()),n}function Ce(e){var t=e.columns,s=e.data,n=Object(Se.useTable)({columns:t,data:s,initialState:{pageSize:10},autoResetPage:!1,autoResetSortBy:!1},Se.useSortBy,Se.usePagination),i=n.getTableProps,a=n.getTableBodyProps,r=n.headerGroups,o=n.page,c=n.prepareRow,l=n.canPreviousPage,h=n.canNextPage,d=n.pageOptions,u=n.pageCount,j=n.gotoPage,p=n.nextPage,b=n.previousPage,O=n.setPageSize,m=n.state,v=m.pageIndex,f=m.pageSize;v>=u&&0!==v&&u>0&&j(u-1);var x=d.length>1&&Object(F.jsxs)(F.Fragment,{children:[Object(F.jsxs)(ye.a,{size:"sm",variant:"dark",children:[Object(F.jsx)(ye.a.First,{onClick:function(){return j(0)},disabled:!l}),Object(F.jsx)(ye.a.Prev,{onClick:function(){return b()},disabled:!l}),we(d.length,v+1,j),Object(F.jsx)(ye.a.Next,{onClick:function(){return p()},disabled:!h}),Object(F.jsx)(ye.a.Last,{onClick:function(){return j(u-1)},disabled:!h})]}),Object(F.jsx)(ye.a,{size:"sm",variant:"dark",children:Object(F.jsx)("select",{value:f,onChange:function(e){O(Number(e.target.value))},children:[10,20,30,40,50,100].map((function(e){return Object(F.jsxs)("option",{value:e,children:["Show ",e]},e)}))})})]});return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsxs)(ke.a,Object(w.a)(Object(w.a)({size:"sm",striped:!0,bordered:!0,hover:!0},i()),{},{children:[Object(F.jsx)("thead",{className:"table-dark",children:r.map((function(e){return Object(F.jsx)("tr",Object(w.a)(Object(w.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e){return Object(F.jsxs)("th",Object(w.a)(Object(w.a)({},e.getHeaderProps(Object(w.a)(Object(w.a)({},e.getSortByToggleProps()),{},{style:{width:e.width}}))),{},{children:[e.render("Header"),e.isSorted?e.isSortedDesc?"\ud83d\udd3d":"\ud83d\udd3c":""]}))}))}))}))}),Object(F.jsx)("tbody",Object(w.a)(Object(w.a)({},a()),{},{children:o.map((function(e,t){return c(e),Object(F.jsx)("tr",Object(w.a)(Object(w.a)({},e.getRowProps()),{},{children:e.cells.map((function(e){return Object(F.jsx)("td",Object(w.a)(Object(w.a)({},e.getCellProps()),{},{children:e.render("Cell")}))}))}))}))}))]})),x]})}var De=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(){return Object(b.a)(this,s),t.apply(this,arguments)}return Object(O.a)(s,[{key:"render",value:function(){var e=[{id:"name",Header:"Name",width:"",accessor:function(e){return function(e){return e.obj.startsWith("k")?Object(F.jsx)(j.b,{to:oe(e.obj),children:(t=e.name,s=e.type,"d"===s?t+"/":t)}):Object(F.jsx)("a",{href:"/api/v1/objects/"+e.obj+"?fname="+encodeURIComponent(e.name),children:e.name});var t,s}(e)}},{id:"mtime",accessor:"mtime",Header:"Last Mod",width:200,Cell:function(e){return re(e.cell.value)}},{id:"size",accessor:function(e){return(t=e).size?t.size:t.summ&&t.summ.size?t.summ.size:0;var t},Header:"Size",width:100,Cell:function(e){return ne(e.cell.value,e.row.original.summ)}},{id:"files",accessor:"summ.files",Header:"Files",width:100},{id:"dirs",accessor:"summ.dirs",Header:"Dirs",width:100}];return Object(F.jsx)(Ce,{data:this.props.items,columns:e})}}]),s}(n.Component),Le=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(){var e;return Object(b.a)(this,s),(e=t.call(this)).state={items:[],isLoading:!1,error:null,mountInfo:{},oid:""},e.mount=e.mount.bind(Object(m.a)(e)),e.unmount=e.unmount.bind(Object(m.a)(e)),e.browseMounted=e.browseMounted.bind(Object(m.a)(e)),e.copyPath=e.copyPath.bind(Object(m.a)(e)),e}return Object(O.a)(s,[{key:"componentDidMount",value:function(){this.fetchDirectory(this.props)}},{key:"fetchDirectory",value:function(e){var t=this,s=e.match.params.oid;this.setState({isLoading:!0,oid:s}),l.a.get("/api/v1/objects/"+s).then((function(e){t.setState({items:e.data.entries||[],isLoading:!1})})).catch((function(e){return t.setState({error:e,isLoading:!1})})),l.a.get("/api/v1/mounts/"+s).then((function(e){t.setState({mountInfo:e.data})})).catch((function(e){return t.setState({mountInfo:{}})}))}},{key:"componentWillReceiveProps",value:function(e){this.fetchDirectory(e)}},{key:"mount",value:function(){var e=this;l.a.post("/api/v1/mounts",{root:this.state.oid}).then((function(t){e.setState({mountInfo:t.data})})).catch((function(t){return e.setState({mountInfo:{}})}))}},{key:"unmount",value:function(){var e=this;l.a.delete("/api/v1/mounts/"+this.state.oid).then((function(t){e.setState({mountInfo:{}})})).catch((function(t){return e.setState({error:t,mountInfo:{}})}))}},{key:"browseMounted",value:function(){window.kopiaUI?window.kopiaUI.browseDirectory(this.state.mountInfo.path):alert("Directory browsing is not supported in a web browser. Use Kopia UI.")}},{key:"copyPath",value:function(){var e=document.querySelector("#mountedPath");e&&(e.select(),e.setSelectionRange(0,99999),document.execCommand("copy"))}},{key:"render",value:function(){var e=this.state,t=e.items,s=e.isLoading,n=e.error;return n?Object(F.jsxs)("p",{children:["ERROR: ",n.message]}):s?Object(F.jsx)($.a,{animation:"border",variant:"primary"}):Object(F.jsxs)("div",{className:"padded",children:[Object(F.jsx)(y.a,{children:Object(F.jsxs)(k.a,{xs:12,children:[Object(F.jsx)(pe,{onClick:this.props.history.goBack}),"\xa0",this.state.mountInfo.path?Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(x.a,{size:"sm",variant:"info",onClick:this.unmount,children:"Unmount"}),window.kopiaUI&&Object(F.jsxs)(F.Fragment,{children:["\xa0",Object(F.jsx)(x.a,{size:"sm",variant:"info",onClick:this.browseMounted,children:"Browse"})]}),"\xa0",Object(F.jsx)("input",{id:"mountedPath",value:this.state.mountInfo.path}),Object(F.jsx)(x.a,{size:"sm",variant:"primary",onClick:this.copyPath,children:Object(F.jsx)(Y.a,{icon:Z.j})})]}):Object(F.jsx)(F.Fragment,{children:Object(F.jsx)(x.a,{size:"sm",variant:"primary",onClick:this.mount,children:"Mount"})}),"\xa0",Object(F.jsx)(x.a,{size:"sm",variant:"info",href:"/snapshots/dir/"+this.props.match.params.oid+"/restore",children:"Restore..."})]})}),Object(F.jsx)(y.a,{children:Object(F.jsx)(k.a,{children:"\xa0"})}),Object(F.jsx)(y.a,{children:Object(F.jsx)(k.a,{xs:12,children:Object(F.jsx)(De,{items:t})})}),Object(F.jsx)(xe,{command:"snapshot list ".concat(this.state.oid)})]})}}]),s}(n.Component),Fe=s.p+"static/media/kopia-flat.d25132f2.svg",Pe=s(34),Ne=s(20),Ie="Local Policies",Te="All Policies",Re="Global Policy",He="Per-User Policies",Ee="Per-Host Policies",ze=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(){var e;return Object(b.a)(this,s),(e=t.call(this)).state={items:[],isLoading:!1,error:null,editorTarget:null,selectedOwner:Ie,policyPath:"",sources:[]},e.editPolicyForPath=e.editPolicyForPath.bind(Object(m.a)(e)),e.handleChange=N.bind(Object(m.a)(e)),e.fetchPolicies=e.fetchPolicies.bind(Object(m.a)(e)),e.fetchSourcesWithoutSpinner=e.fetchSourcesWithoutSpinner.bind(Object(m.a)(e)),e}return Object(O.a)(s,[{key:"componentDidMount",value:function(){this.setState({isLoading:!0}),this.fetchPolicies(),this.fetchSourcesWithoutSpinner()}},{key:"sync",value:function(){var e=this;this.fetchPolicies(),l.a.post("/api/v1/repo/sync",{}).then((function(t){e.fetchSourcesWithoutSpinner()})).catch((function(t){e.setState({error:t,isLoading:!1})}))}},{key:"fetchPolicies",value:function(){var e=this;l.a.get("/api/v1/policies").then((function(t){e.setState({items:t.data.policies,isLoading:!1})})).catch((function(t){he(t),e.setState({error:t,isLoading:!1})}))}},{key:"fetchSourcesWithoutSpinner",value:function(){var e=this;l.a.get("/api/v1/sources").then((function(t){e.setState({localSourceName:t.data.localUsername+"@"+t.data.localHost,localUsername:t.data.localUsername,localHost:t.data.localHost,multiUser:t.data.multiUser,sources:t.data.sources,isLoading:!1})})).catch((function(t){he(t),e.setState({error:t,isLoading:!1})}))}},{key:"editPolicyForPath",value:function(e){e.preventDefault(),this.state.policyPath&&(!function(e){if(e.startsWith("/"))return!0;if(e.length>=3&&":\\"===e.substring(1,3)){var t=e.substring(0,1).toUpperCase();return t>="A"&&t<="Z"}return!!e.startsWith("\\\\")}(this.state.policyPath)?alert("Policies can only be defined for absolute paths."):this.props.history.push(Oe({userName:this.state.localUsername,host:this.state.localHost,path:this.state.policyPath})))}},{key:"selectOwner",value:function(e){this.setState({selectedOwner:e})}},{key:"policySummary",value:function(e){function t(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var s=[];return t(e.policy.retention)||s.push(Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(Pe.a,{bg:"success",children:"retention"})," "]})),t(e.policy.files)||s.push(Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(Pe.a,{bg:"primary",children:"files"})," "]})),t(e.policy.errorHandling)||s.push(Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(Pe.a,{bg:"danger",children:"errors"})," "]})),t(e.policy.compression)||s.push(Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(Pe.a,{bg:"secondary",children:"compression"})," "]})),t(e.policy.scheduling)||s.push(Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(Pe.a,{bg:"warning",children:"scheduling"})," "]})),s}},{key:"render",value:function(){var e=this,t=this.state,s=t.items,n=t.sources,i=t.isLoading,a=t.error;if(a)return Object(F.jsx)("p",{children:a.message});if(i)return Object(F.jsx)("p",{children:"Loading ..."});var r=n.reduce((function(e,t){var s=ce(t.source);return e.includes(s)||e.push(s),e}),[]);switch(r.sort(),this.state.selectedOwner){case Te:break;case Re:s=s.filter((function(e){return!e.target.userName&&!e.target.host&&!e.target.path}));break;case Ie:s=s.filter((function(t){return ce(t.target)===e.state.localSourceName&&t.target.path.startsWith(e.state.policyPath)}));break;case He:s=s.filter((function(e){return!!e.target.userName&&!!e.target.host&&!e.target.path}));break;case Ee:s=s.filter((function(e){return!e.target.userName&&!!e.target.host&&!e.target.path}));break;default:s=s.filter((function(t){return ce(t.target)===e.state.selectedOwner}))}s.sort((function(e,t){var s=le(e.target.host,t.target.host);if(s)return s;var n=le(e.target.userName,t.target.userName);return n||le(e.target.path,t.target.path)}));var o=[{Header:"Username",accessor:function(e){return e.target.userName||"*"}},{Header:"Host",accessor:function(e){return e.target.host||"*"}},{Header:"Path",accessor:function(e){return e.target.path||"*"}},{Header:"Defined",width:300,accessor:function(t){return e.policySummary(t)}},{id:"edit",Header:"",width:50,Cell:function(e){return Object(F.jsx)(j.b,{to:Oe(e.row.original.target),children:Object(F.jsx)(x.a,{size:"sm",children:"Edit"})})}}];return Object(F.jsxs)("div",{className:"padded",children:[!this.state.editorTarget&&Object(F.jsx)("div",{className:"list-actions",children:Object(F.jsx)(g.a,{onSubmit:this.editPolicyForPath,children:Object(F.jsxs)(y.a,{children:[Object(F.jsx)(k.a,{xs:"auto",children:Object(F.jsxs)(Ne.a,{children:[Object(F.jsxs)(Ne.a.Toggle,{size:"sm",variant:"outline-primary",id:"dropdown-basic",children:[Object(F.jsx)(Y.a,{icon:Z.u}),"\xa0",this.state.selectedOwner]}),Object(F.jsxs)(Ne.a.Menu,{children:[Object(F.jsx)(Ne.a.Item,{onClick:function(){return e.selectOwner(Ie)},children:Ie}),Object(F.jsx)(Ne.a.Item,{onClick:function(){return e.selectOwner(Te)},children:Te}),Object(F.jsx)(Ne.a.Divider,{}),Object(F.jsx)(Ne.a.Item,{onClick:function(){return e.selectOwner(Re)},children:Re}),Object(F.jsx)(Ne.a.Item,{onClick:function(){return e.selectOwner(He)},children:He}),Object(F.jsx)(Ne.a.Item,{onClick:function(){return e.selectOwner(Ee)},children:Ee}),Object(F.jsx)(Ne.a.Divider,{}),r.map((function(t){return Object(F.jsx)(Ne.a.Item,{onClick:function(){return e.selectOwner(t)},children:t},t)}))]})]})}),this.state.selectedOwner===Ie?Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(k.a,{children:Object(F.jsx)(fe,{autoFocus:!0,onDirectorySelected:function(t){return e.setState({policyPath:t})},placeholder:"enter directory to find or set policy",name:"policyPath",value:this.state.policyPath,onChange:this.handleChange})}),Object(F.jsx)(k.a,{xs:"auto",children:Object(F.jsx)(x.a,{disabled:!this.state.policyPath,size:"sm",type:"submit",onClick:this.editPolicyForPath,children:"Set Policy"})})]}):Object(F.jsx)(k.a,{})]})})}),s.length>0?Object(F.jsxs)("div",{children:[Object(F.jsxs)("p",{children:["Found ",s.length," policies matching criteria."]}),Object(F.jsx)(Ce,{data:s,columns:o})]}):this.state.selectedOwner===Ie&&this.state.policyPath?Object(F.jsxs)("p",{children:["No policy found for directory ",Object(F.jsx)("code",{children:this.state.policyPath}),". Click ",Object(F.jsx)("b",{children:"Set Policy"})," to define it."]}):Object(F.jsx)("p",{children:"No policies found."}),Object(F.jsx)(xe,{command:"policy list"})]})}}]),s}(n.Component),Ae=s(57),Ue=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this)).state=Object(w.a)({},e.initial),n.handleChange=N.bind(Object(m.a)(n)),n}return Object(O.a)(s,[{key:"validate",value:function(){return P(this,["container","storageAccount"])}},{key:"render",value:function(){return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsxs)(y.a,{children:[T(this,"Container","container",{autoFocus:!0,placeholder:"enter container name"}),R(this,"Object Name Prefix","prefix",{placeholder:"enter object name prefix or leave empty"})]}),Object(F.jsxs)(y.a,{children:[T(this,"Storage Account","storageAccount",{placeholder:"enter access key ID"}),R(this,"Access Key","storageKey",{placeholder:"enter secret access key",type:"password"})]}),Object(F.jsxs)(y.a,{children:[R(this,"Azure Storage Domain","storageDomain",{placeholder:"enter storage domain or leave empty for default 'blob.core.windows.net'"}),R(this,"SAS Token","sasToken",{placeholder:"enter secret SAS Token",type:"password"})]})]})}}]),s}(n.Component),Be=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this)).state=Object(w.a)({},e.initial),n.handleChange=N.bind(Object(m.a)(n)),n}return Object(O.a)(s,[{key:"validate",value:function(){return P(this,["bucket","keyId","key"])}},{key:"render",value:function(){return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(y.a,{children:T(this,"B2 Bucket","bucket",{autoFocus:!0,placeholder:"enter bucket name"})}),Object(F.jsxs)(y.a,{children:[T(this,"Key ID","keyId",{placeholder:"enter application or account key ID"}),T(this,"Key","key",{placeholder:"enter secret application or account key",type:"password"})]}),Object(F.jsx)(y.a,{children:R(this,"Object Name Prefix","prefix",{placeholder:"enter object name prefix or leave empty",type:"password"})})]})}}]),s}(n.Component),Ge=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this)).state=Object(w.a)({},e.initial),n.handleChange=N.bind(Object(m.a)(n)),n}return Object(O.a)(s,[{key:"validate",value:function(){return P(this,["path"])}},{key:"render",value:function(){return Object(F.jsx)(F.Fragment,{children:Object(F.jsx)(y.a,{children:T(this,"Directory Path","path",{autoFocus:!0,placeholder:"enter path to a directory where to store repository files"})})})}}]),s}(n.Component),Me=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this)).state=Object(w.a)({},e.initial),n.handleChange=N.bind(Object(m.a)(n)),n}return Object(O.a)(s,[{key:"validate",value:function(){return P(this,["bucket"])}},{key:"render",value:function(){return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsxs)(y.a,{children:[T(this,"GCS Bucket","bucket",{autoFocus:!0,placeholder:"enter bucket name"}),R(this,"Object Name Prefix","prefix",{placeholder:"enter object name prefix or leave empty",type:"password"})]}),Object(F.jsx)(y.a,{children:R(this,"Credentials File","credentialsFile",{placeholder:"enter name of credentials JSON file"})}),Object(F.jsx)(y.a,{children:R(this,"Credentials JSON","credentials",{placeholder:"paste JSON credentials here",as:"textarea",rows:5})})]})}}]),s}(n.Component),We=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this)).state=Object(w.a)({},e.initial),n.handleChange=N.bind(Object(m.a)(n)),n}return Object(O.a)(s,[{key:"validate",value:function(){return P(this,["url"])}},{key:"render",value:function(){return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(y.a,{children:T(this,"Server address","url",{autoFocus:!0,placeholder:"enter server URL (https://<host>:port)"})}),Object(F.jsx)(y.a,{children:R(this,"Trusted server certificate fingerprint (SHA256)","serverCertFingerprint",{placeholder:"enter trusted server certificate fingerprint printed at server startup"})})]})}}]),s}(n.Component),Ke=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this)).state=Object(w.a)({},e.initial),n.handleChange=N.bind(Object(m.a)(n)),n}return Object(O.a)(s,[{key:"validate",value:function(){return P(this,["remotePath"])}},{key:"render",value:function(){return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(y.a,{children:T(this,"Rclone Remote Path","remotePath",{autoFocus:!0,placeholder:"enter <name-of-rclone-remote>:<path>"})}),Object(F.jsx)(y.a,{children:R(this,"rclone executable","rcloneExe",{placeholder:"enter path to rclone executable"})})]})}}]),s}(n.Component),Ve=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this)).state=Object(w.a)({doNotUseTLS:!1,doNotVerifyTLS:!1},e.initial),n.handleChange=N.bind(Object(m.a)(n)),n}return Object(O.a)(s,[{key:"validate",value:function(){return P(this,["bucket","endpoint","accessKeyID","secretAccessKey"])}},{key:"render",value:function(){return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsxs)(y.a,{children:[T(this,"S3 Bucket","bucket",{autoFocus:!0,placeholder:"enter bucket name"}),T(this,"Server Endpoint","endpoint",{placeholder:"enter server address (e.g. s3.amazonaws.com)"}),R(this,"Override S3 Region","region",{placeholder:"enter specific region (e.g. us-west-1) or leave empty"})]}),Object(F.jsxs)(y.a,{children:[G(this,"Use HTTP connection (insecure)","doNotUseTLS"),G(this,"Do not verify TLS certificate","doNotVerifyTLS")]}),Object(F.jsxs)(y.a,{children:[T(this,"Access Key ID","accessKeyID",{placeholder:"enter access key ID"}),T(this,"Secret Access Key","secretAccessKey",{placeholder:"enter secret access key",type:"password"}),R(this,"Session Token","sessionToken",{placeholder:"enter session token or leave empty",type:"password"})]}),Object(F.jsx)(y.a,{children:R(this,"Object Name Prefix","prefix",{placeholder:"enter object name prefix or leave empty",type:"password"})})]})}}]),s}(n.Component),qe=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this)).state=Object(w.a)({port:22,validated:!1},e.initial),n.handleChange=N.bind(Object(m.a)(n)),n}return Object(O.a)(s,[{key:"validate",value:function(){return this.setState({validated:!0}),!!P(this,["host","port","username","path"])&&(!!this.state.externalSSH||!!U(this,["password","keyfile","keyData"])&&!!U(this,["knownHostsFile","knownHostsData"]))}},{key:"render",value:function(){return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsxs)(y.a,{children:[T(this,"Host","host",{autoFocus:!0,placeholder:"ssh host name (e.g. example.com)"}),T(this,"User","username",{placeholder:"user name"}),z(this,"Port","port",{placeholder:"port number (e.g. 22)"})]}),Object(F.jsx)(y.a,{children:T(this,"Path","path",{placeholder:"enter remote path to repository, e.g. '/mnt/data/repository'"})}),!this.state.externalSSH&&Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(y.a,{children:R(this,"Password","password",{type:"password",placeholder:"password"})}),Object(F.jsxs)(y.a,{children:[R(this,"Path to key file","keyfile",{placeholder:"enter path to the key file"}),R(this,"Path to known_hosts File","knownHostsFile",{placeholder:"enter path to known_hosts file"})]}),Object(F.jsxs)(y.a,{children:[R(this,"Key Data","keyData",{placeholder:"paste contents of the key file",as:"textarea",rows:5,isInvalid:this.state.validated&&!this.state.externalSSH&&!U(this,["password","keyfile","keyData"])},null,Object(F.jsxs)(F.Fragment,{children:["One of ",Object(F.jsx)("b",{children:"Password"}),", ",Object(F.jsx)("b",{children:"Key File"})," or ",Object(F.jsx)("b",{children:"Key Data"})," is required."]})),R(this,"Known Hosts Data","knownHostsData",{placeholder:"paste contents of the known_hosts file",as:"textarea",rows:5,isInvalid:this.state.validated&&!this.state.externalSSH&&!U(this,["knownHostsFile","knownHostsData"])},null,Object(F.jsxs)(F.Fragment,{children:["Either ",Object(F.jsx)("b",{children:"Known Hosts File"})," or ",Object(F.jsx)("b",{children:"Known Hosts Data"})," is required, but not both."]}))]}),Object(F.jsx)("hr",{})]}),G(this,"Launch external password-less SSH command","externalSSH","By default Kopia connects to the server using internal SSH client which supports limited options. Alternatively it may launch external password-less SSH command, which supports additional options, but is generally less efficient than the built-in client."),this.state.externalSSH&&Object(F.jsx)(F.Fragment,{children:Object(F.jsxs)(y.a,{children:[R(this,"SSH Command","sshCommand",{placeholder:"provide enter passwordless SSH command to execute (typically 'ssh')"}),R(this,"SSH Arguments","sshArguments",{placeholder:"enter SSH command arguments ('user@host -s sftp' will be appended automatically)"})]})})]})}}]),s}(n.Component),_e=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this)).state=Object(w.a)({},e.initial),n.handleChange=N.bind(Object(m.a)(n)),n}return Object(O.a)(s,[{key:"validate",value:function(){return P(this,["token"])}},{key:"render",value:function(){return Object(F.jsx)(F.Fragment,{children:Object(F.jsx)(y.a,{children:T(this,"Token","token",{autoFocus:!0,type:"password",placeholder:"paste connection token"})})})}}]),s}(n.Component),Je=[{provider:"filesystem",description:"Filesystem",component:Ge},{provider:"gcs",description:"Google Cloud Storage",component:Me},{provider:"s3",description:"Amazon S3, Minio, Wasabi, etc.",component:Ve},{provider:"b2",description:"Backblaze B2",component:Be},{provider:"azureBlob",description:"Azure Blob Storage",component:Ue},{provider:"sftp",description:"SFTP server",component:qe},{provider:"rclone",description:"Rclone remote",component:Ke},{provider:"webdav",description:"WebDAV server",component:function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(e){var n;return Object(b.a)(this,s),(n=t.call(this)).state=Object(w.a)({},e.initial),n.handleChange=N.bind(Object(m.a)(n)),n}return Object(O.a)(s,[{key:"validate",value:function(){return P(this,["url"])}},{key:"render",value:function(){return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(y.a,{children:T(this,"WebDAV Server URL","url",{autoFocus:!0,placeholder:"http[s]://server:port/path"})}),Object(F.jsxs)(y.a,{children:[R(this,"Username","username",{placeholder:"enter username"}),R(this,"Password","password",{placeholder:"enter password",type:"password"})]})]})}}]),s}(n.Component)},{provider:"_server",description:"Kopia Repository Server",component:We},{provider:"_token",description:"Use Repository Token",component:_e}],Ze=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(){var e;return Object(b.a)(this,s),(e=t.call(this)).state={confirmCreate:!1,isLoading:!1,showAdvanced:!1,storageVerified:!1,providerSettings:{},description:"My Repository",formatVersion:"2"},e.handleChange=N.bind(Object(m.a)(e)),e.optionsEditor=i.a.createRef(),e.connectToRepository=e.connectToRepository.bind(Object(m.a)(e)),e.createRepository=e.createRepository.bind(Object(m.a)(e)),e.cancelCreate=e.cancelCreate.bind(Object(m.a)(e)),e.toggleAdvanced=e.toggleAdvanced.bind(Object(m.a)(e)),e.verifyStorage=e.verifyStorage.bind(Object(m.a)(e)),e}return Object(O.a)(s,[{key:"componentDidMount",value:function(){var e=this;l.a.get("/api/v1/repo/algorithms").then((function(t){e.setState({algorithms:t.data,hash:t.data.defaultHash,encryption:t.data.defaultEncryption,splitter:t.data.defaultSplitter,indexVersion:""})})),l.a.get("/api/v1/current-user").then((function(t){e.setState({username:t.data.username,hostname:t.data.hostname})}))}},{key:"validate",value:function(){var e=this.optionsEditor.current,t=!0;return"_token"!==this.state.provider&&(P(this,["password"])||(t=!1)),e&&!e.validate()&&(t=!1),this.state.confirmCreate&&(P(this,["confirmPassword"])||(t=!1),t&&this.state.password!==this.state.confirmPassword)?(alert("Passwords don't match"),!1):t}},{key:"createRepository",value:function(e){var t=this;if(e.preventDefault(),this.validate()){var s={storage:{type:this.state.provider,config:this.state.providerSettings},password:this.state.password,options:{blockFormat:{version:parseInt(this.state.formatVersion),hash:this.state.hash,encryption:this.state.encryption},objectFormat:{splitter:this.state.splitter}}};s.clientOptions=this.clientOptions(),l.a.post("/api/v1/repo/create",s).then((function(e){window.location.replace("/")})).catch((function(e){e.response.data&&t.setState({connectError:e.response.data.code+": "+e.response.data.error})}))}}},{key:"connectToRepository",value:function(e){var t=this;if(e.preventDefault(),this.validate()){var s=null;switch(this.state.provider){case"_token":s={token:this.state.providerSettings.token};break;case"_server":s={apiServer:this.state.providerSettings,password:this.state.password};break;default:s={storage:{type:this.state.provider,config:this.state.providerSettings},password:this.state.password}}s.clientOptions=this.clientOptions(),this.setState({isLoading:!0}),l.a.post("/api/v1/repo/connect",s).then((function(e){t.setState({isLoading:!1}),window.location.replace("/")})).catch((function(e){t.setState({isLoading:!1}),e.response.data&&t.setState({confirmCreate:!1,connectError:e.response.data.code+": "+e.response.data.error})}))}}},{key:"clientOptions",value:function(){return{description:this.state.description,username:this.state.username,readonly:this.state.readonly,hostname:this.state.hostname}}},{key:"toggleAdvanced",value:function(){this.setState({showAdvanced:!this.state.showAdvanced})}},{key:"cancelCreate",value:function(){this.setState({confirmCreate:!1})}},{key:"renderProviderSelection",value:function(){var e=this;return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)("h3",{children:"Select Storage Type"}),Object(F.jsx)("p",{children:"To connect to a repository or create one, select the preferred storage type."}),Object(F.jsx)(y.a,{children:Je.map((function(t){return Object(F.jsx)(x.a,{"data-testid":"provider-"+t.provider,onClick:function(){return e.setState({provider:t.provider,providerSettings:{}})},variant:t.provider.startsWith("_")?"outline-success":"outline-primary",className:"providerIcon",children:t.description},t.provider)}))})]})}},{key:"verifyStorage",value:function(e){var t=this;e.preventDefault();var s=this.optionsEditor.current;if(!s||s.validate())if("_token"!==this.state.provider&&"_server"!==this.state.provider){var n={storage:{type:this.state.provider,config:s.state}};this.setState({isLoading:!0}),l.a.post("/api/v1/repo/exists",n).then((function(e){t.setState({storageVerified:!0,confirmCreate:!1,isLoading:!1,providerSettings:s.state})})).catch((function(e){t.setState({isLoading:!1}),e.response.data?"NOT_INITIALIZED"===e.response.data.code?t.setState({confirmCreate:!0,storageVerified:!0,providerSettings:s.state,connectError:null}):t.setState({connectError:e.response.data.code+": "+e.response.data.error}):t.setState({connectError:e.message})}))}else this.setState({storageVerified:!0,confirmCreate:!1,isLoading:!1,providerSettings:s.state})}},{key:"renderProviderConfiguration",value:function(){var e,t=this,s=null,n=Object(S.a)(Je);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.provider===this.state.provider&&(s=i.component)}}catch(a){n.e(a)}finally{n.f()}return Object(F.jsxs)(g.a,{onSubmit:this.verifyStorage,children:[!this.state.provider.startsWith("_")&&Object(F.jsx)("h3",{children:"Storage Configuration"}),"_token"===this.state.provider&&Object(F.jsx)("h3",{children:"Enter Repository Token"}),"_server"===this.state.provider&&Object(F.jsx)("h3",{children:"Kopia Server Parameters"}),Object(F.jsx)(s,{ref:this.optionsEditor,initial:this.state.providerSettings}),this.connectionErrorInfo(),Object(F.jsx)("hr",{}),Object(F.jsx)(x.a,{variant:"secondary",onClick:function(){return t.setState({provider:null,providerSettings:null,connectError:null})},children:"Back"}),"\xa0",Object(F.jsx)(x.a,{variant:"primary",type:"submit","data-testid":"submit-button",children:"Next"}),this.loadingSpinner()]})}},{key:"toggleAdvancedButton",value:function(){return Object(F.jsx)(x.a,{onClick:this.toggleAdvanced,variant:"secondary","aria-controls":"advanced-options-div","aria-expanded":this.state.showAdvanced,size:"sm",children:this.state.showAdvanced?Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(Y.a,{icon:Z.b}),"\xa0Hide Advanced Options"]}):Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(Y.a,{icon:Z.a}),"\xa0Show Advanced Options"]})})}},{key:"renderConfirmCreate",value:function(){var e=this;return Object(F.jsxs)(g.a,{onSubmit:this.createRepository,children:[Object(F.jsx)("h3",{children:"Create New Repository"}),Object(F.jsx)("p",{children:"Enter a strong password to create Kopia repository in the provided storage."}),Object(F.jsxs)(y.a,{children:[T(this,"Repository Password","password",{autoFocus:!0,type:"password",placeholder:"enter repository password"},"The password used to encrypt repository contents."),T(this,"Confirm Repository Password","confirmPassword",{type:"password",placeholder:"enter repository password again"})]}),this.toggleAdvancedButton(),Object(F.jsx)(Ae.a,{in:this.state.showAdvanced,children:Object(F.jsxs)("div",{id:"advanced-options-div",children:[Object(F.jsxs)(y.a,{children:[Object(F.jsxs)(g.a.Group,{as:k.a,children:[Object(F.jsx)(g.a.Label,{className:"required",children:"Encryption"}),Object(F.jsx)(g.a.Control,{as:"select",name:"encryption",onChange:this.handleChange,"data-testid":"control-encryption",value:this.state.encryption,children:this.state.algorithms.encryption.map((function(e){return Object(F.jsx)("option",{value:e,children:e},e)}))})]}),Object(F.jsxs)(g.a.Group,{as:k.a,children:[Object(F.jsx)(g.a.Label,{className:"required",children:"Hash Algorithm"}),Object(F.jsx)(g.a.Control,{as:"select",name:"hash",onChange:this.handleChange,"data-testid":"control-hash",value:this.state.hash,children:this.state.algorithms.hash.map((function(e){return Object(F.jsx)("option",{value:e,children:e},e)}))})]}),Object(F.jsxs)(g.a.Group,{as:k.a,children:[Object(F.jsx)(g.a.Label,{className:"required",children:"Splitter"}),Object(F.jsx)(g.a.Control,{as:"select",name:"splitter",onChange:this.handleChange,"data-testid":"control-splitter",value:this.state.splitter,children:this.state.algorithms.splitter.map((function(e){return Object(F.jsx)("option",{value:e,children:e},e)}))})]}),Object(F.jsxs)(g.a.Group,{as:k.a,children:[Object(F.jsx)(g.a.Label,{className:"required",children:"Repository Format"}),Object(F.jsxs)(g.a.Control,{as:"select",name:"formatVersion",onChange:this.handleChange,"data-testid":"control-formatVersion",value:this.state.formatVersion,children:[Object(F.jsx)("option",{value:"2",children:"Latest format"}),Object(F.jsx)("option",{value:"1",children:"Legacy format compatible with v0.8"})]})]})]}),this.overrideUsernameHostnameRow(),Object(F.jsx)(y.a,{children:Object(F.jsx)(g.a.Group,{as:k.a,children:Object(F.jsx)(g.a.Text,{children:"Additional parameters can be set when creating repository using command line"})})})]})}),this.connectionErrorInfo(),Object(F.jsx)("hr",{}),Object(F.jsx)(x.a,{variant:"secondary",onClick:function(){return e.setState({storageVerified:!1})},children:"Back"}),"\xa0",Object(F.jsx)(x.a,{variant:"success",type:"submit","data-testid":"submit-button",children:"Create Repository"}),this.loadingSpinner()]})}},{key:"overrideUsernameHostnameRow",value:function(){return Object(F.jsxs)(y.a,{children:[T(this,"Username","username",{},"Override this when restoring snapshot taken by another user."),T(this,"Hostname","hostname",{},"Override this when restoring snapshot taken on another machine.")]})}},{key:"connectionErrorInfo",value:function(){return this.state.connectError&&Object(F.jsx)(y.a,{children:Object(F.jsx)(g.a.Group,{as:k.a,children:Object(F.jsxs)(g.a.Text,{className:"error",children:["Connect Error: ",this.state.connectError]})})})}},{key:"renderConfirmConnect",value:function(){var e=this;return Object(F.jsxs)(g.a,{onSubmit:this.connectToRepository,children:[Object(F.jsx)("h3",{children:"Connect To Repository"}),Object(F.jsx)(y.a,{children:Object(F.jsxs)(g.a.Group,{as:k.a,children:[Object(F.jsx)(g.a.Label,{className:"required",children:"Connect As"}),Object(F.jsx)(g.a.Control,{value:this.state.username+"@"+this.state.hostname,readOnly:!0,size:"sm"}),Object(F.jsx)(g.a.Text,{className:"text-muted",children:"To override, click 'Show Advanced Options'"})]})}),Object(F.jsxs)(y.a,{children:["_token"!==this.state.provider&&"_server"!==this.state.provider&&T(this,"Repository Password","password",{autoFocus:!0,type:"password",placeholder:"enter repository password"},"The password used to encrypt repository contents."),"_server"===this.state.provider&&T(this,"Server Password","password",{autoFocus:!0,type:"password",placeholder:"enter password to connect to server"})]}),Object(F.jsx)(y.a,{children:T(this,"Repository Description","description",{autoFocus:"_token"===this.state.provider,placeholder:"enter repository description"},"Description helps you distinguish between multiple connected repositories.")}),this.toggleAdvancedButton(),Object(F.jsx)(Ae.a,{in:this.state.showAdvanced,children:Object(F.jsxs)("div",{id:"advanced-options-div",className:"advancedOptions",children:[Object(F.jsx)(y.a,{children:G(this,"Connect in read-only mode","readonly","Read-only mode prevents any changes to the repository.")}),this.overrideUsernameHostnameRow()]})}),this.connectionErrorInfo(),Object(F.jsx)("hr",{}),Object(F.jsx)(x.a,{variant:"secondary",onClick:function(){return e.setState({storageVerified:!1})},children:"Back"}),"\xa0",Object(F.jsx)(x.a,{variant:"success",type:"submit","data-testid":"submit-button",children:"Connect To Repository"}),this.loadingSpinner()]})}},{key:"renderInternal",value:function(){return this.state.provider?this.state.storageVerified?this.state.confirmCreate?this.renderConfirmCreate():this.renderConfirmConnect():this.renderProviderConfiguration():this.renderProviderSelection()}},{key:"loadingSpinner",value:function(){return this.state.isLoading&&Object(F.jsx)($.a,{animation:"border",variant:"primary"})}},{key:"render",value:function(){return Object(F.jsx)(F.Fragment,{children:this.renderInternal()})}}]),s}(n.Component),Ye=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(){var e;return Object(b.a)(this,s),(e=t.call(this)).state={status:{},isLoading:!0,error:null,provider:"",description:""},e.mounted=!1,e.disconnect=e.disconnect.bind(Object(m.a)(e)),e.updateDescription=e.updateDescription.bind(Object(m.a)(e)),e.handleChange=N.bind(Object(m.a)(e)),e}return Object(O.a)(s,[{key:"componentDidMount",value:function(){this.mounted=!0,this.fetchStatus(this.props)}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"fetchStatus",value:function(e){var t=this;this.mounted&&this.setState({isLoading:!0}),l.a.get("/api/v1/repo/status").then((function(e){t.mounted&&t.setState({status:e.data,isLoading:!1})})).catch((function(e){t.mounted&&t.setState({error:e,isLoading:!1})}))}},{key:"disconnect",value:function(){var e=this;this.setState({isLoading:!0}),l.a.post("/api/v1/repo/disconnect",{}).then((function(e){window.location.replace("/")})).catch((function(t){return e.setState({error:t,isLoading:!1})}))}},{key:"selectProvider",value:function(e){this.setState({provider:e})}},{key:"updateDescription",value:function(){var e=this;this.setState({isLoading:!0}),l.a.post("/api/v1/repo/description",{description:this.state.status.description}).then((function(t){e.setState({isLoading:!1})})).catch((function(t){e.setState({isLoading:!1})}))}},{key:"render",value:function(){var e=this.state,t=e.isLoading,s=e.error;return s?Object(F.jsxs)("p",{children:["ERROR: ",s.message]}):t?Object(F.jsx)($.a,{animation:"border",variant:"primary"}):this.state.status.connected?Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)("h3",{children:"Connected To Repository"}),Object(F.jsxs)(g.a,{onSubmit:this.updateDescription,children:[Object(F.jsx)(y.a,{children:Object(F.jsxs)(g.a.Group,{as:k.a,children:[Object(F.jsxs)(X.a,{children:[Object(F.jsx)(g.a.Control,{autoFocus:"true",isInvalid:!this.state.status.description,name:"status.description",value:this.state.status.description,onChange:this.handleChange,size:"sm"}),"\xa0",Object(F.jsx)(x.a,{size:"sm",type:"submit",children:"Update Description"})]}),Object(F.jsx)(g.a.Control.Feedback,{type:"invalid",children:"Description Is Required"})]})}),this.state.status.readonly&&Object(F.jsx)(y.a,{children:Object(F.jsx)(Pe.a,{pill:!0,variant:"warning",children:"Repository is read-only"})})]}),Object(F.jsx)("hr",{}),Object(F.jsxs)(g.a,{children:[this.state.status.apiServerURL?Object(F.jsx)(F.Fragment,{children:Object(F.jsx)(y.a,{children:Object(F.jsxs)(g.a.Group,{as:k.a,children:[Object(F.jsx)(g.a.Label,{children:"Server URL"}),Object(F.jsx)(g.a.Control,{readOnly:!0,defaultValue:this.state.status.apiServerURL})]})})}):Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(y.a,{children:Object(F.jsxs)(g.a.Group,{as:k.a,children:[Object(F.jsx)(g.a.Label,{children:"Config File"}),Object(F.jsx)(g.a.Control,{readOnly:!0,defaultValue:this.state.status.configFile})]})}),Object(F.jsxs)(y.a,{children:[Object(F.jsxs)(g.a.Group,{as:k.a,children:[Object(F.jsx)(g.a.Label,{children:"Provider"}),Object(F.jsx)(g.a.Control,{readOnly:!0,defaultValue:this.state.status.storage})]}),Object(F.jsxs)(g.a.Group,{as:k.a,children:[Object(F.jsx)(g.a.Label,{children:"Hash Algorithm"}),Object(F.jsx)(g.a.Control,{readOnly:!0,defaultValue:this.state.status.hash})]}),Object(F.jsxs)(g.a.Group,{as:k.a,children:[Object(F.jsx)(g.a.Label,{children:"Encryption Algorithm"}),Object(F.jsx)(g.a.Control,{readOnly:!0,defaultValue:this.state.status.encryption})]}),Object(F.jsxs)(g.a.Group,{as:k.a,children:[Object(F.jsx)(g.a.Label,{children:"Splitter Algorithm"}),Object(F.jsx)(g.a.Control,{readOnly:!0,defaultValue:this.state.status.splitter})]}),Object(F.jsxs)(g.a.Group,{as:k.a,children:[Object(F.jsx)(g.a.Label,{children:"Internal Compression"}),Object(F.jsx)(g.a.Control,{readOnly:!0,defaultValue:this.state.status.supportsContentCompression?"yes":"no"})]})]})]}),Object(F.jsx)(y.a,{children:Object(F.jsxs)(g.a.Group,{as:k.a,children:[Object(F.jsx)(g.a.Label,{children:"Connected as:"}),Object(F.jsx)(g.a.Control,{readOnly:!0,defaultValue:this.state.status.username+"@"+this.state.status.hostname})]})}),Object(F.jsx)(y.a,{children:Object(F.jsx)(k.a,{children:"\xa0"})}),Object(F.jsx)(y.a,{children:Object(F.jsx)(k.a,{children:Object(F.jsx)(x.a,{size:"sm",variant:"danger",onClick:this.disconnect,children:"Disconnect"})})})]}),Object(F.jsx)(y.a,{children:Object(F.jsx)(k.a,{children:"\xa0"})}),Object(F.jsx)(y.a,{children:Object(F.jsx)(k.a,{xs:12,children:Object(F.jsx)(xe,{command:"repository status"})})})]}):Object(F.jsx)(Ze,{})}}]),s}(n.Component);var Qe=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(){var e;return Object(b.a)(this,s),(e=t.call(this)).state={snapshots:[],showHidden:!1,isLoading:!1,error:null},e.onChange=e.onChange.bind(Object(m.a)(e)),e}return Object(O.a)(s,[{key:"componentDidUpdate",value:function(e,t){this.state.showHidden!==t.showHidden&&this.fetchSnapshots()}},{key:"componentDidMount",value:function(){this.fetchSnapshots()}},{key:"fetchSnapshots",value:function(){var e=this,t=ae(this.props.location.search);this.setState({isLoading:!0,host:t.host,userName:t.userName,path:t.path,hiddenCount:0,selectedSnapshot:null});var s="/api/v1/snapshots?"+me(t);this.state.showHidden&&(s+="&all=1"),l.a.get(s).then((function(t){console.log("got snapshots",t.data),e.setState({snapshots:t.data.snapshots,unfilteredCount:t.data.unfilteredCount,uniqueCount:t.data.uniqueCount,isLoading:!1})})).catch((function(t){return e.setState({error:t,isLoading:!1})}))}},{key:"selectSnapshot",value:function(e){this.setState({selectedSnapshot:e})}},{key:"onChange",value:function(e){this.setState({showHidden:e.target.checked})}},{key:"render",value:function(){var e=this.state,t=e.snapshots,s=e.unfilteredCount,n=e.uniqueCount,i=e.isLoading,a=e.error;if(a)return Object(F.jsx)("p",{children:a.message});if(i)return Object(F.jsx)($.a,{animation:"border",variant:"primary"});t.sort((function(e,t){return-le(e.startTime,t.startTime)}));var r=[{id:"startTime",Header:"Start time",width:200,accessor:function(e){return Object(F.jsx)(j.b,{to:oe(e.rootID),children:re(e.startTime)})}},{id:"rootID",Header:"Root",width:"",accessor:function(e){return e.rootID}},{Header:"Retention",accessor:"retention",width:"",Cell:function(e){return Object(F.jsx)("span",{children:e.cell.value.map((function(e){return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(Pe.a,{bg:(t=e,t.startsWith("latest-")?"success":t.startsWith("daily-")?"info":t.startsWith("weekly-")?"danger":t.startsWith("monthly-")?"dark":t.startsWith("annual-")?"warning":"primary"),children:e})," "]});var t}))})}},{Header:"Size",accessor:"summary.size",width:100,Cell:function(e){return ne(e.cell.value,e.row.original.summary)}},{Header:"Files",accessor:"summary.files",width:100},{Header:"Dirs",accessor:"summary.dirs",width:100}];return Object(F.jsxs)("div",{className:"padded",children:[Object(F.jsx)(y.a,{children:Object(F.jsxs)(k.a,{children:[Object(F.jsx)(pe,{onClick:this.props.history.goBack}),"\xa0 Displaying ",t.length!==s?t.length+" out of "+s:t.length," snapshots of\xa0",Object(F.jsxs)("b",{children:[this.state.userName,"@",this.state.host,":",this.state.path]}),s!==n&&Object(F.jsxs)(F.Fragment,{children:["\xa0",Object(F.jsx)(g.a.Group,{controlId:"formBasicCheckbox",children:Object(F.jsx)(g.a.Check,{type:"checkbox",checked:this.state.showHidden,label:"Show "+s+" individual snapshots",onChange:this.onChange})})]})]})}),Object(F.jsx)(y.a,{children:Object(F.jsx)(k.a,{xs:12,children:Object(F.jsx)(Ce,{data:t,columns:r})})}),Object(F.jsx)(xe,{command:'snapshot list "'.concat(this.state.userName,"@").concat(this.state.host,":").concat(this.state.path,'"').concat(this.state.showHidden?" --show-identical":"")})]})}}]),s}(n.Component),Xe=s(41),$e=s.n(Xe),et="Local Snapshots",tt="All Snapshots",st=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(){var e;return Object(b.a)(this,s),(e=t.call(this)).state={sources:[],isLoading:!1,isRefreshing:!1,error:null,localSourceName:"",multiUser:!1,selectedOwner:et,selectedDirectory:""},e.sync=e.sync.bind(Object(m.a)(e)),e.fetchSourcesWithoutSpinner=e.fetchSourcesWithoutSpinner.bind(Object(m.a)(e)),e.handleChange=N.bind(Object(m.a)(e)),e.cancelSnapshot=e.cancelSnapshot.bind(Object(m.a)(e)),e.startSnapshot=e.startSnapshot.bind(Object(m.a)(e)),e}return Object(O.a)(s,[{key:"componentDidMount",value:function(){this.setState({isLoading:!0}),this.fetchSourcesWithoutSpinner(),this.interval=window.setInterval(this.fetchSourcesWithoutSpinner,3e3)}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.interval)}},{key:"fetchSourcesWithoutSpinner",value:function(){var e=this;l.a.get("/api/v1/sources").then((function(t){e.setState({localSourceName:t.data.localUsername+"@"+t.data.localHost,multiUser:t.data.multiUser,sources:t.data.sources,isLoading:!1,isRefreshing:!1})})).catch((function(t){he(t),e.setState({error:t,isRefreshing:!1,isLoading:!1})}))}},{key:"selectOwner",value:function(e){this.setState({selectedOwner:e})}},{key:"sync",value:function(){var e=this;this.setState({isRefreshing:!0}),l.a.post("/api/v1/repo/sync",{}).then((function(t){e.fetchSourcesWithoutSpinner()})).catch((function(t){ve(t),e.setState({error:t,isRefreshing:!1})}))}},{key:"statusCell",value:function(e,t){switch(e.cell.value){case"IDLE":return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(x.a,{variant:"primary",size:"sm",onClick:function(){t.startSnapshot(e.row.original.source)},children:"Snapshot now"}),"\xa0",Object(F.jsx)(j.b,{to:Oe(e.row.original.source),children:Object(F.jsx)(x.a,{size:"sm",variant:"info",children:"Policy"})})]});case"PENDING":return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)($.a,{animation:"border",variant:"secondary",size:"sm",title:"Snapshot will after the previous snapshot completes"}),"\xa0Pending"]});case"UPLOADING":var s=e.row.original.upload,n="",i="";if(s){n=" hashed "+s.hashedFiles+" files ("+ie(s.hashedBytes)+")\n cached "+s.cachedFiles+" files ("+ie(s.cachedBytes)+")\n dir "+s.directory;var a=s.hashedBytes+s.cachedBytes;if(i=ie(a),s.estimatedBytes){i+="/"+ie(s.estimatedBytes);var r=Math.round(1e3*a/s.estimatedBytes)/10;r<=100&&(i+=" "+r+"%")}}return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)($.a,{animation:"border",variant:"primary",size:"sm",title:n}),"\xa0",i,"\xa0",e.row.original.currentTask&&Object(F.jsx)(j.b,{to:"/tasks/"+e.row.original.currentTask,children:"Details"})]});default:return""}}},{key:"cancelSnapshot",value:function(e){var t=this;l.a.post("/api/v1/sources/cancel?"+me(e),{}).then((function(e){t.fetchSourcesWithoutSpinner()})).catch((function(e){ve(e)}))}},{key:"startSnapshot",value:function(e){var t=this;l.a.post("/api/v1/sources/upload?"+me(e),{}).then((function(e){t.fetchSourcesWithoutSpinner()})).catch((function(e){ve(e)}))}},{key:"render",value:function(){var e=this,t=this.state,s=t.sources,n=t.isLoading,i=t.error;if(i)return Object(F.jsx)("p",{children:i.message});if(n)return Object(F.jsx)($.a,{animation:"border",variant:"primary"});var a=s.reduce((function(e,t){var s=ce(t.source);return e.includes(s)||e.push(s),e}),[]);switch(a.sort(),this.state.selectedOwner){case tt:break;case et:s=s.filter((function(t){return ce(t.source)===e.state.localSourceName}));break;default:s=s.filter((function(t){return ce(t.source)===e.state.selectedOwner}))}var r=[{id:"path",Header:"Path",accessor:function(e){return e.source},sortType:function(e,t){var s=le(e.original.source.path,t.original.source.path);return 0!==s?s:le(ce(e.original.source),ce(t.original.source))},width:"",Cell:function(e){return Object(F.jsx)(j.b,{to:"/snapshots/single-source?"+me(e.cell.value),children:e.cell.value.path})}},{id:"owner",Header:"Owner",accessor:function(e){return e.source.userName+"@"+e.source.host},width:250},{id:"lastSnapshotSize",Header:"Size",width:120,accessor:function(e){return e.lastSnapshot?e.lastSnapshot.stats.totalSize:0},Cell:function(e){return ne(e.cell.value,e.row.original.lastSnapshot&&e.row.original.lastSnapshot.rootEntry?e.row.original.lastSnapshot.rootEntry.summ:null)}},{id:"lastSnapshotTime",Header:"Last Snapshot",width:160,accessor:function(e){return e.lastSnapshot?e.lastSnapshot.startTime:null},Cell:function(e){return e.cell.value?Object(F.jsx)("p",{title:$e()(e.cell.value).toLocaleString(),children:$e()(e.cell.value).fromNow()}):""}},{id:"nextSnapshotTime",Header:"Next Snapshot",width:160,accessor:function(e){return e.nextSnapshotTime},Cell:function(e){return e.cell.value&&"UPLOADING"!==e.row.original.status?Object(F.jsx)(F.Fragment,{children:Object(F.jsxs)("p",{title:$e()(e.cell.value).toLocaleString(),children:[$e()(e.cell.value).fromNow(),$e()(e.cell.value).isBefore($e()())&&Object(F.jsxs)(F.Fragment,{children:["\xa0",Object(F.jsx)(Pe.a,{bg:"secondary",children:"overdue"})]})]})}):""}},{id:"status",Header:"",width:300,accessor:function(e){return e.status},Cell:function(t){return e.statusCell(t,e)}}];return Object(F.jsxs)("div",{className:"padded",children:[Object(F.jsx)("div",{className:"list-actions",children:Object(F.jsxs)(y.a,{children:[this.state.multiUser&&Object(F.jsx)(F.Fragment,{children:Object(F.jsx)(k.a,{xs:"auto",children:Object(F.jsxs)(Ne.a,{children:[Object(F.jsxs)(Ne.a.Toggle,{size:"sm",variant:"outline-primary",id:"dropdown-basic",children:[Object(F.jsx)(Y.a,{icon:Z.u}),"\xa0",this.state.selectedOwner]}),Object(F.jsxs)(Ne.a.Menu,{children:[Object(F.jsx)(Ne.a.Item,{onClick:function(){return e.selectOwner(et)},children:et}),Object(F.jsx)(Ne.a.Item,{onClick:function(){return e.selectOwner(tt)},children:tt}),Object(F.jsx)(Ne.a.Divider,{}),a.map((function(t){return Object(F.jsx)(Ne.a.Item,{onClick:function(){return e.selectOwner(t)},children:t},t)}))]})]})})}),Object(F.jsx)(k.a,{xs:"auto",children:Object(F.jsx)(x.a,{size:"sm",variant:"success",href:"/snapshots/new",children:"New Snapshot"})}),Object(F.jsx)(k.a,{}),Object(F.jsx)(k.a,{xs:"auto",children:Object(F.jsx)(x.a,{size:"sm",variant:"primary",children:this.state.isRefreshing?Object(F.jsx)($.a,{animation:"border",variant:"light",size:"sm"}):Object(F.jsx)(Y.a,{icon:Z.s,onClick:this.sync})})})]})}),Object(F.jsx)(Ce,{data:s,columns:r}),Object(F.jsx)(xe,{command:"snapshot list"})]})}}]),s}(n.Component),nt=s(56),it=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(){var e;return Object(b.a)(this,s),(e=t.call(this)).state={items:[],isLoading:!1,error:null},e.handleChange=N.bind(Object(m.a)(e)),e.fetchLog=e.fetchLog.bind(Object(m.a)(e)),e.interval=window.setInterval(e.fetchLog,3e3),e.messagesEndRef=i.a.createRef(),e.scrollToBottom=e.scrollToBottom.bind(Object(m.a)(e)),e}return Object(O.a)(s,[{key:"componentDidMount",value:function(){this.setState({isLoading:!0}),this.fetchLog(),this.scrollToBottom()}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.interval)}},{key:"lastMessage",value:function(e){return e&&e.length?e[e.length-1].msg:""}},{key:"fetchLog",value:function(){var e=this;l.a.get("/api/v1/tasks/"+this.props.taskID+"/logs").then((function(t){var s=e.state.logs;e.setState({logs:t.data.logs,isLoading:!1}),e.lastMessage(s)!==e.lastMessage(t.data.logs)&&e.scrollToBottom()})).catch((function(t){he(t),e.setState({error:t,isLoading:!1})}))}},{key:"fullLogTime",value:function(e){return new Date(1e3*e).toLocaleString()}},{key:"formatLogTime",value:function(e){var t=new Date(1e3*e),s="";return s+=("0"+t.getHours()).substr(-2),s+=":",s+=("0"+t.getMinutes()).substr(-2),s+=":",s+=("0"+t.getSeconds()).substr(-2),s+=".",s+=("00"+t.getMilliseconds()).substr(-3)}},{key:"scrollToBottom",value:function(){var e=this.messagesEndRef.current;e&&e.scrollIntoView({behavior:"smooth"})}},{key:"render",value:function(){var e=this,t=this.state,s=t.logs,n=t.isLoading,i=t.error;return i?Object(F.jsx)("p",{children:i.message}):n?Object(F.jsx)("p",{children:"Loading ..."}):s?Object(F.jsxs)("div",{className:"logs-table",children:[Object(F.jsx)(ke.a,{size:"sm",children:Object(F.jsx)("tbody",{children:s.map((function(t){return Object(F.jsxs)("tr",{className:"loglevel-"+t.level,children:[Object(F.jsx)("td",{title:e.fullLogTime(t.ts),children:e.formatLogTime(t.ts)}),Object(F.jsx)("td",{class:"elide",children:t.msg})]})}))})}),Object(F.jsx)("div",{ref:this.messagesEndRef})]}):null}}]),s}(n.Component),at=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(){var e;return Object(b.a)(this,s),(e=t.call(this)).state={items:[],isLoading:!0,error:null,showLog:!1},e.taskID=e.taskID.bind(Object(m.a)(e)),e.fetchTask=e.fetchTask.bind(Object(m.a)(e)),e.interval=window.setInterval((function(){return e.fetchTask(e.props)}),500),e}return Object(O.a)(s,[{key:"componentDidMount",value:function(){this.setState({isLoading:!0}),this.fetchTask(this.props)}},{key:"componentWillUnmount",value:function(){this.interval&&window.clearInterval(this.interval)}},{key:"taskID",value:function(e){return e.taskID||e.match.params.tid}},{key:"fetchTask",value:function(e){var t=this;l.a.get("/api/v1/tasks/"+this.taskID(e)).then((function(e){t.setState({task:e.data,isLoading:!1}),e.data.endTime&&(window.clearInterval(t.interval),t.interval=null)})).catch((function(e){he(e),t.setState({error:e,isLoading:!1})}))}},{key:"componentWillReceiveProps",value:function(e){this.fetchTask(e)}},{key:"summaryControl",value:function(e){var t=ue(e.startTime,e.endTime);switch(e.status){case"SUCCESS":return Object(F.jsxs)(nt.a,{variant:"success",children:["Task succeeded after ",t,"."]});case"FAILED":return Object(F.jsxs)(nt.a,{variant:"danger",children:[Object(F.jsx)("b",{children:"Error:"})," ",e.errorMessage,"."]});case"CANCELED":return Object(F.jsx)(nt.a,{variant:"warning",children:"Task canceled."});case"CANCELING":return Object(F.jsxs)(nt.a,{variant:"primary",children:[Object(F.jsx)($.a,{animation:"border",variant:"warning",size:"sm"})," Canceling ",t,": ",e.progressInfo,"."]});default:return Object(F.jsxs)(nt.a,{variant:"primary",children:[Object(F.jsx)($.a,{animation:"border",variant:"primary",size:"sm"})," Running for ",t,": ",e.progressInfo,"."]})}}},{key:"valueThreshold",value:function(){return this.props.showZeroCounters?-1:0}},{key:"counterBadge",value:function(e,t){if(t.value<this.valueThreshold())return"";var s=t.value.toLocaleString();"bytes"===t.units&&(s=ie(t.value));var n="secondary";switch(t.level){case"warning":n="warning";break;case"error":n="danger";break;case"notice":n="info";break;default:n="secondary"}return Object(F.jsxs)(Pe.a,{className:"counter-badge",bg:n,children:[e,": ",s]},e)}},{key:"counterLevelToSortOrder",value:function(e){switch(e){case"error":return 30;case"notice":return 10;case"warning":return 5;default:return 0}}},{key:"sortedBadges",value:function(e){var t=this,s=Object.keys(e);return s.sort((function(s,n){return e[s].level!==e[n].level?t.counterLevelToSortOrder(e[n].level)-t.counterLevelToSortOrder(e[s].level):s<n?-1:s>n?1:0})),s.map((function(s){return e[s].value>t.valueThreshold()&&t.counterBadge(s,e[s])}))}},{key:"render",value:function(){var e=this,t=this.state,s=t.task,n=t.isLoading,i=t.error;return i?Object(F.jsx)("p",{children:i.message}):n?Object(F.jsx)("p",{children:"Loading ..."}):Object(F.jsxs)(g.a,{children:[this.props.history&&Object(F.jsx)(y.a,{children:Object(F.jsxs)(g.a.Group,{children:[Object(F.jsx)(pe,{onClick:this.props.history.goBack}),"RUNNING"===s.status&&Object(F.jsxs)(F.Fragment,{children:["\xa0",Object(F.jsxs)(x.a,{size:"sm",variant:"danger",onClick:function(){return je(s.id)},children:[Object(F.jsx)(Y.a,{icon:Z.r})," Stop "]})]})]})}),!this.props.hideDescription&&Object(F.jsxs)(y.a,{children:[Object(F.jsx)(k.a,{xs:3,children:Object(F.jsx)(g.a.Group,{children:Object(F.jsx)(g.a.Control,{type:"text",readOnly:!0,value:s.kind})})}),Object(F.jsx)(k.a,{xs:9,children:Object(F.jsx)(g.a.Group,{children:Object(F.jsx)(g.a.Control,{type:"text",readOnly:!0,value:s.description})})})]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(k.a,{xs:9,children:this.summaryControl(s)}),Object(F.jsx)(k.a,{xs:3,children:Object(F.jsx)(g.a.Group,{children:Object(F.jsx)(g.a.Control,{type:"text",readOnly:!0,value:"Started: "+new Date(s.startTime).toLocaleString()})})})]}),s.counters&&Object(F.jsx)(y.a,{children:Object(F.jsx)(k.a,{children:this.sortedBadges(s.counters)})}),Object(F.jsx)("hr",{}),Object(F.jsx)(y.a,{children:Object(F.jsx)(k.a,{children:this.state.showLog?Object(F.jsxs)(F.Fragment,{children:[Object(F.jsxs)(x.a,{size:"sm",onClick:function(){return e.setState({showLog:!1})},children:[Object(F.jsx)(Y.a,{icon:Z.g})," Hide Log"]}),Object(F.jsx)(it,{taskID:this.taskID(this.props)})]}):Object(F.jsxs)(x.a,{size:"sm",onClick:function(){return e.setState({showLog:!0})},children:[Object(F.jsx)(Y.a,{icon:Z.f})," Show Log"]})})})]})}}]),s}(n.Component),rt=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(){var e;return Object(b.a)(this,s),(e=t.call(this)).state={items:[],isLoading:!1,error:null,showKind:"All",showStatus:"All",uniqueKinds:[]},e.handleChange=N.bind(Object(m.a)(e)),e.fetchTasks=e.fetchTasks.bind(Object(m.a)(e)),e.interval=window.setInterval(e.fetchTasks,3e3),e}return Object(O.a)(s,[{key:"componentDidMount",value:function(){this.setState({isLoading:!0}),this.fetchTasks()}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.interval)}},{key:"getUniqueKinds",value:function(e){var t,s={},n=Object(S.a)(e);try{for(n.s();!(t=n.n()).done;){s[t.value.kind]=!0}}catch(r){n.e(r)}finally{n.f()}var i=[];for(var a in s)i.push(a);return i}},{key:"fetchTasks",value:function(){var e=this;l.a.get("/api/v1/tasks").then((function(t){e.setState({items:t.data.tasks,uniqueKinds:e.getUniqueKinds(t.data.tasks),isLoading:!1})})).catch((function(t){he(t),e.setState({error:t,isLoading:!1})}))}},{key:"taskMatches",value:function(e){return("All"===this.state.showKind||e.kind===this.state.showKind)&&(("All"===this.state.showStatus||e.status.toLowerCase()===this.state.showStatus.toLowerCase())&&!(this.state.searchDescription&&e.description.indexOf(this.state.searchDescription)<0))}},{key:"filterItems",value:function(e){var t=this;return e.filter((function(e){return t.taskMatches(e)}))}},{key:"render",value:function(){var e=this,t=this.state,s=t.items,n=t.isLoading,i=t.error;if(i)return Object(F.jsx)("p",{children:i.message});if(n)return Object(F.jsx)("p",{children:"Loading ..."});var a=[{Header:"Start Time",width:200,accessor:function(e){return Object(F.jsx)(j.b,{to:"/tasks/"+e.id,title:$e()(e.startTime).toLocaleString(),children:$e()(e.startTime).fromNow()})}},{Header:"Status",width:200,accessor:function(e){return function(e){var t=e.status,s=ue(e.startTime,e.endTime);switch(t){case"RUNNING":return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)($.a,{animation:"border",variant:"primary",size:"sm"})," Running for ",s,"\xa0",Object(F.jsx)(Y.a,{size:"sm",color:"red",icon:Z.v,title:"Cancel task",onClick:function(){return je(e.id)}})]});case"SUCCESS":return Object(F.jsxs)("p",{children:[Object(F.jsx)(Y.a,{icon:Z.e,color:"green"})," Finished in ",s]});case"FAILED":return Object(F.jsxs)("p",{children:[Object(F.jsx)(Y.a,{icon:Z.k,color:"red"})," Failed after ",s]});case"CANCELED":return Object(F.jsxs)("p",{children:[Object(F.jsx)(Y.a,{icon:Z.c})," Canceled after ",s]});default:return t}}(e)}},{Header:"Kind",width:"",accessor:function(e){return Object(F.jsx)("p",{children:e.kind})}},{Header:"Description",width:"",accessor:function(e){return Object(F.jsx)("p",{children:e.description})}}],r=this.filterItems(s);return Object(F.jsx)("div",{className:"padded",children:Object(F.jsxs)(g.a,{children:[Object(F.jsx)("div",{className:"list-actions",children:Object(F.jsxs)(y.a,{children:[Object(F.jsx)(k.a,{xs:"auto",children:Object(F.jsxs)(Ne.a,{children:[Object(F.jsxs)(Ne.a.Toggle,{size:"sm",variant:"primary",children:["Status: ",this.state.showStatus]}),Object(F.jsxs)(Ne.a.Menu,{children:[Object(F.jsx)(Ne.a.Item,{onClick:function(){return e.setState({showStatus:"All"})},children:"All"}),Object(F.jsx)(Ne.a.Divider,{}),Object(F.jsx)(Ne.a.Item,{onClick:function(){return e.setState({showStatus:"Running"})},children:"Running"}),Object(F.jsx)(Ne.a.Item,{onClick:function(){return e.setState({showStatus:"Failed"})},children:"Failed"})]})]})}),Object(F.jsx)(k.a,{xs:"auto",children:Object(F.jsxs)(Ne.a,{children:[Object(F.jsxs)(Ne.a.Toggle,{size:"sm",variant:"primary",children:["Kind: ",this.state.showKind]}),Object(F.jsxs)(Ne.a.Menu,{children:[Object(F.jsx)(Ne.a.Item,{onClick:function(){return e.setState({showKind:"All"})},children:"All"}),Object(F.jsx)(Ne.a.Divider,{}),this.state.uniqueKinds.map((function(t){return Object(F.jsx)(Ne.a.Item,{onClick:function(){return e.setState({showKind:t})},children:t})}))]})]})}),Object(F.jsx)(k.a,{xs:"4",children:Object(F.jsx)(g.a.Control,{size:"sm",type:"text",name:"searchDescription",placeholder:"search description",value:this.state.searchDescription,onChange:this.handleChange,autoFocus:!0})})]})}),Object(F.jsx)(y.a,{children:Object(F.jsx)(k.a,{children:s.length?Object(F.jsx)(Ce,{data:r,columns:a}):Object(F.jsxs)(nt.a,{variant:"info",children:[Object(F.jsx)(Y.a,{size:"sm",icon:Z.p})," A list of tasks will appear here when you create snapshots, restore, run maintenance, etc."]})})})]})})}}]),s}(n.Component),ot=s(23);function ct(e){return Object(F.jsxs)(k.a,{xs:12,sm:4,className:"policyFieldColumn",children:[Object(F.jsx)("span",{className:"policyField",children:e.name}),e.help&&Object(F.jsx)(F.Fragment,{children:Object(F.jsx)("p",{className:"label-help",children:e.help})})]})}function lt(e){return Object(F.jsx)(k.a,{xs:12,sm:4,className:"policyValue",children:e.children})}function ht(e){return Object(F.jsx)(k.a,{xs:12,sm:4,className:"policyValue",children:e.children})}function dt(e,t){var s=L(e,"resolved.definition."+t,void 0);return Object(F.jsx)(pt,{children:Object(F.jsxs)(g.a.Group,{children:[Object(F.jsx)(g.a.Control,{"data-testid":"effective-"+t,size:"sm",value:L(e,"resolved.effective."+t,void 0),readOnly:!0}),Object(F.jsx)(g.a.Text,{"data-testid":"definition-"+t,children:e.PolicyDefinitionPoint(s)})]})})}function ut(e,t){var s=L(e,"resolved.definition."+t,void 0);return Object(F.jsx)(pt,{children:Object(F.jsxs)(g.a.Group,{children:[Object(F.jsx)(g.a.Control,{"data-testid":"effective-"+t,size:"sm",as:"textarea",rows:"5",value:L(e,"resolved.effective."+t,void 0),readOnly:!0}),Object(F.jsx)(g.a.Text,{"data-testid":"definition-"+t,children:e.PolicyDefinitionPoint(s)})]})})}function jt(e,t){var s=L(e,"resolved.definition."+t,void 0);return Object(F.jsx)(pt,{children:Object(F.jsxs)(g.a.Group,{children:[Object(F.jsx)(g.a.Check,{"data-testid":"effective-"+t,size:"sm",checked:L(e,"resolved.effective."+t,void 0),readOnly:!0}),Object(F.jsx)(g.a.Text,{"data-testid":"definition-"+t,children:e.PolicyDefinitionPoint(s)})]})})}function pt(e){return Object(F.jsx)(k.a,{xs:12,sm:4,className:"policyEffectiveValue",children:e.children})}function bt(){return Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{}),Object(F.jsx)(lt,{children:Object(F.jsx)("div",{className:"policyEditorHeader"})}),Object(F.jsx)(pt,{children:Object(F.jsx)("div",{className:"policyEditorHeader",children:"Effective"})})]})}var Ot=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(){var e;return Object(b.a)(this,s),(e=t.call(this)).state={items:[],isLoading:!1,error:null},e.fetchPolicy=e.fetchPolicy.bind(Object(m.a)(e)),e.handleChange=N.bind(Object(m.a)(e)),e.saveChanges=e.saveChanges.bind(Object(m.a)(e)),e.isGlobal=e.isGlobal.bind(Object(m.a)(e)),e.deletePolicy=e.deletePolicy.bind(Object(m.a)(e)),e.policyURL=e.policyURL.bind(Object(m.a)(e)),e.resolvePolicy=e.resolvePolicy.bind(Object(m.a)(e)),e.PolicyDefinitionPoint=e.PolicyDefinitionPoint.bind(Object(m.a)(e)),e.getAndValidatePolicy=e.getAndValidatePolicy.bind(Object(m.a)(e)),e}return Object(O.a)(s,[{key:"componentDidMount",value:function(){var e=this;l.a.get("/api/v1/repo/algorithms").then((function(t){e.setState({algorithms:t.data}),e.fetchPolicy(e.props)}))}},{key:"componentDidUpdate",value:function(e){me(this.props)!==me(e)&&this.fetchPolicy(this.props);var t=JSON.stringify(this.state.policy);t!==this.lastResolvedPolicy&&(this.resolvePolicy(this.props),this.lastResolvedPolicy=t)}},{key:"fetchPolicy",value:function(e){var t=this;l.a.get(this.policyURL(e)).then((function(e){t.setState({isLoading:!1,policy:e.data})})).catch((function(e){e.response&&"NOT_FOUND"!==e.response.data.code?t.setState({error:e,isLoading:!1}):t.setState({policy:{},isNew:!0,isLoading:!1})}))}},{key:"resolvePolicy",value:function(e){var t=this,s="/api/v1/policy/resolve?"+me(e);try{l.a.post(s,{updates:this.getAndValidatePolicy(),numUpcomingSnapshotTimes:5}).then((function(e){t.setState({resolved:e.data})})).catch((function(e){}))}catch(n){}}},{key:"PolicyDefinitionPoint",value:function(e){return e?e.userName===this.props.userName&&e.host===this.props.host&&e.path===this.props.path?"(Defined by this policy)":Object(F.jsxs)(F.Fragment,{children:["Defined by ",(t=e,Object(F.jsx)(j.b,{to:Oe(t),children:be(t)}))]}):"";var t}},{key:"getAndValidatePolicy",value:function(){function e(e){if(!e)return e;for(var t=[],s=0;s<e.length;s++){var n=e[s];""!==n&&t.push(n)}return t}var t=JSON.parse(JSON.stringify(this.state.policy));return t.files&&(t.files.ignore&&(t.files.ignore=e(t.files.ignore)),t.files.ignoreDotFiles&&(t.files.ignoreDotFiles=e(t.files.ignoreDotFiles))),t.compression&&(t.compression.onlyCompress&&(t.compression.onlyCompress=e(t.compression.onlyCompress)),t.compression.neverCompress&&(t.compression.neverCompress=e(t.compression.neverCompress))),t.scheduling&&t.scheduling.timeOfDay&&(t.scheduling.timeOfDay=function(e){var t,s=Object(S.a)(e);try{for(s.s();!(t=s.n()).done;){var n=t.value;if(!n.hour)throw Error("invalid time of day: '"+n+"'")}}catch(i){s.e(i)}finally{s.f()}return e}(e(t.scheduling.timeOfDay))),t}},{key:"saveChanges",value:function(e){var t=this;e.preventDefault();try{var s=this.getAndValidatePolicy();this.setState({saving:!0}),l.a.put(this.policyURL(this.props),s).then((function(e){t.props.close()})).catch((function(e){t.setState({saving:!1}),ve(e,"Error saving policy")}))}catch(e){return void ve(e)}}},{key:"deletePolicy",value:function(){var e=this;window.confirm("Are you sure you want to delete this policy?")&&(this.setState({saving:!0}),l.a.delete(this.policyURL(this.props)).then((function(t){e.props.close()})).catch((function(t){e.setState({saving:!1}),ve(t,"Error deleting policy")})))}},{key:"policyURL",value:function(e){return"/api/v1/policy?"+me(e)}},{key:"isGlobal",value:function(){return!this.props.host&&!this.props.userName&&!this.props.path}},{key:"render",value:function(){var e,t,s,n=this,i=this.state,a=i.isLoading,r=i.error;return r?Object(F.jsx)("p",{children:r.message}):a?Object(F.jsx)("p",{children:"Loading ..."}):Object(F.jsx)("div",{className:"padded",children:Object(F.jsxs)(g.a,{onSubmit:this.saveChanges,children:[Object(F.jsxs)(ot.a,{defaultActiveKey:"scheduling",children:[Object(F.jsxs)(ot.a.Item,{eventKey:"retention",children:[Object(F.jsxs)(ot.a.Header,{children:[Object(F.jsx)(Y.a,{icon:Z.d}),"\xa0Snapshot Retention"]}),Object(F.jsxs)(ot.a.Body,{children:[Object(F.jsx)(bt,{}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Latest Snapshots",help:"Number of the most recent snapshots to retain per source."}),Object(F.jsx)(lt,{children:z(this,null,"policy.retention.keepLatest",{placeholder:"# of latest snapshots"})}),dt(this,"retention.keepLatest")]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Hourly",help:"How many hourly snapshots to retain per source. The latest snapshot from each hour will be retained."}),Object(F.jsx)(lt,{children:z(this,null,"policy.retention.keepHourly",{placeholder:"# of hourly snapshots"})}),dt(this,"retention.keepHourly")]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Daily",help:"How many daily snapshots to retain per source. The latest snapshot from each day will be retained."}),Object(F.jsx)(lt,{children:z(this,null,"policy.retention.keepDaily",{placeholder:"# of daily snapshots"})}),dt(this,"retention.keepDaily")]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Weekly",help:"How many weekly snapshots to retain per source. The latest snapshot from each week will be retained."}),Object(F.jsx)(lt,{children:z(this,null,"policy.retention.keepWeekly",{placeholder:"# of weekly snapshots"})}),dt(this,"retention.keepWeekly")]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Monthly",help:"How many monthly snapshots to retain per source. The latest snapshot from each calendar month will be retained."}),Object(F.jsx)(lt,{children:z(this,null,"policy.retention.keepMonthly",{placeholder:"# of monthly snapshots"})}),dt(this,"retention.keepMonthly")]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Annual",help:"How many annual snapshots to retain per source. The latest snapshot from each calendar year will be retained."}),Object(F.jsx)(lt,{children:z(this,null,"policy.retention.keepAnnual",{placeholder:"# of annual snapshots"})}),dt(this,"retention.keepAnnual")]})]})]}),Object(F.jsxs)(ot.a.Item,{eventKey:"files",children:[Object(F.jsxs)(ot.a.Header,{children:[Object(F.jsx)(Y.a,{icon:Z.o}),"\xa0Files"]}),Object(F.jsxs)(ot.a.Body,{children:[Object(F.jsx)(bt,{}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Ignore Files",help:"List of file and directory names to ignore. The patterns should be specified as relative to the directory they are defined in and not absolute. Wilcards are allowed."}),Object(F.jsx)(ht,{children:V(this,"policy.files.ignore")}),ut(this,"files.ignore")]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Ignore Rules From Parent Directories",help:"When set, ignore rules from the parent directory are ignored."}),Object(F.jsx)(lt,{children:G(this,"","policy.files.noParentIgnore")}),Object(F.jsx)(pt,{})]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Ignore Rule Files",help:"List of additional files containing ignore rules. Each file configures ignore rules for the directory and its subdirectories."}),Object(F.jsx)(lt,{children:V(this,"policy.files.ignoreDotFiles")}),ut(this,"files.ignoreDotFiles")]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Ignore Rule Files From Parent Directories",help:"When set, the files specifying ignore rules (.kopiaignore, etc.) from the parent directory are ignored."}),Object(F.jsx)(lt,{children:G(this,"","policy.files.noParentDotFiles")}),Object(F.jsx)(pt,{})]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Ignore Well-Known Cache Directories",help:"Ignore directories containing CACHEDIR.TAG and similar."}),Object(F.jsx)(lt,{children:W(this,null,"policy.files.ignoreCacheDirs","inherit from parent")}),jt(this,"files.ignoreCacheDirs")]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Scan only one filesystem",help:"Do not cross filesystem boundaries when snapshotting."}),Object(F.jsx)(lt,{children:W(this,null,"policy.files.oneFileSystem","inherit from parent")}),jt(this,"files.oneFileSystem")]})]})]}),Object(F.jsxs)(ot.a.Item,{eventKey:"errors",children:[Object(F.jsxs)(ot.a.Header,{children:[Object(F.jsx)(Y.a,{icon:Z.l}),"\xa0Error Handling"]}),Object(F.jsxs)(ot.a.Body,{children:[Object(F.jsx)(bt,{}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Ignore Directory Errors",help:"Treat directory read errors as non-fatal."}),Object(F.jsx)(lt,{children:W(this,null,"policy.errorHandling.ignoreDirectoryErrors","inherit from parent")}),jt(this,"errorHandling.ignoreDirectoryErrors")]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Ignore File Errors",help:"Treat file read errors as non-fatal."}),Object(F.jsx)(lt,{children:W(this,null,"policy.errorHandling.ignoreFileErrors","inherit from parent")}),jt(this,"errorHandling.ignoreFileErrors")]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Ignore Unknown Directory Entries",help:"Treat unrecognized/unsupported directory entries as non-fatal errors."}),Object(F.jsx)(lt,{children:W(this,null,"policy.errorHandling.ignoreUnknownTypes","inherit from parent")}),jt(this,"errorHandling.ignoreUnknownTypes")]})]})]}),Object(F.jsxs)(ot.a.Item,{eventKey:"compression",children:[Object(F.jsxs)(ot.a.Header,{children:[Object(F.jsx)(Y.a,{icon:Z.n}),"\xa0Compression"]}),Object(F.jsxs)(ot.a.Body,{children:[Object(F.jsx)(bt,{}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Compression Algorithm",help:"Specify compression algorithm to use when snapshotting files in this directory and subdirectories."}),Object(F.jsx)(ht,{children:Object(F.jsxs)(g.a.Control,{as:"select",size:"sm",name:"policy.compression.compressorName",onChange:this.handleChange,value:I(this,"policy.compression.compressorName"),children:[Object(F.jsx)("option",{value:"",children:"(none)"}),this.state.algorithms&&this.state.algorithms.compression.map((function(e){return Object(F.jsx)("option",{value:e,children:e},e)}))]})}),dt(this,"compression.compressorName")]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Minimum File Size",help:"Files whose size is below the provided value will not be compressed."}),Object(F.jsx)(lt,{children:z(this,"","policy.compression.minSize",{placeholder:"minimum file size in bytes"})}),dt(this,"compression.minSize")]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Max File Size",help:"Files whose size exceeds the provided value will not be compressed."}),Object(F.jsx)(lt,{children:z(this,"","policy.compression.maxSize",{placeholder:"maximum file size in bytes"})}),dt(this,"compression.maxSize")]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Only Compress Extensions",help:"Only compress files with the following file extensions (one extension per line)"}),Object(F.jsx)(ht,{children:V(this,"policy.compression.onlyCompress")}),ut(this,"compression.onlyCompress")]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Never Compress Extensions",help:"Never compress the following file extensions (one extension per line)"}),Object(F.jsx)(ht,{children:V(this,"policy.compression.neverCompress")}),ut(this,"compression.neverCompress")]})]})]}),Object(F.jsxs)(ot.a.Item,{eventKey:"scheduling",children:[Object(F.jsxs)(ot.a.Header,{children:[Object(F.jsx)(Y.a,{icon:Z.i}),"\xa0Scheduling"]}),Object(F.jsxs)(ot.a.Body,{children:[Object(F.jsx)(bt,{}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Snapshot Frequency",help:"How frequently to create snapshots in KopiaUI or kopia server. This option has no effect outside of the server mode."}),Object(F.jsx)(ht,{children:Object(F.jsxs)(g.a.Control,{as:"select",size:"sm",name:"policy.scheduling.intervalSeconds",onChange:function(e){return n.handleChange(e,H)},value:I(this,"policy.scheduling.intervalSeconds"),children:[Object(F.jsx)("option",{value:"",children:"(none)"}),Object(F.jsx)("option",{value:"600",children:"every 10 minutes"}),Object(F.jsx)("option",{value:"900",children:"every 15 minutes"}),Object(F.jsx)("option",{value:"1200",children:"every 20 minutes"}),Object(F.jsx)("option",{value:"1800",children:"every 30 minutes"}),Object(F.jsx)("option",{value:"3600",children:"every hour"}),Object(F.jsx)("option",{value:"10800",children:"every 3 hours"}),Object(F.jsx)("option",{value:"21600",children:"every 6 hours"}),Object(F.jsx)("option",{value:"43200",children:"every 12 hours"})]})}),dt(this,"scheduling.intervalSeconds")]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Times Of Day",help:"Create snapshots at the provided times of day, one per line, 24h time (e.g. 17:00,18:00)"}),Object(F.jsx)(lt,{children:q(this,"policy.scheduling.timeOfDay")}),jt(this,"scheduling.manual")]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Manual Snapshots Only",help:"Only create snapshots manually (disables scheduled snapshots)."}),Object(F.jsx)(lt,{children:W(this,"","policy.scheduling.manual","inherit from parent")}),jt(this,"scheduling.manual")]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Upcoming Snapshots",help:"Times of upcoming snapshots calculated based on policy parameters."}),Object(F.jsx)(lt,{}),Object(F.jsx)(pt,{children:(s=null===(e=this.state)||void 0===e||null===(t=e.resolved)||void 0===t?void 0:t.upcomingSnapshotTimes,s?Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(ct,{"name-":"Upcoming"}),Object(F.jsx)("ul",{"data-testid":"upcoming-snapshot-times",children:s.map((function(e){return Object(F.jsxs)("li",{children:[$e()(e).format("L LT")," (",$e()(e).fromNow(),")"]},e)}))})]}):Object(F.jsx)(ct,{name:"No upcoming snapshots"}))})]})]})]}),Object(F.jsxs)(ot.a.Item,{eventKey:"logging",children:[Object(F.jsxs)(ot.a.Header,{children:[Object(F.jsx)(Y.a,{icon:Z.m}),"\xa0Logging"]}),Object(F.jsxs)(ot.a.Body,{children:[Object(F.jsx)(bt,{}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Directory Snapshotted",help:"Log verbosity when a directory is snapshotted."}),Object(F.jsx)(ht,{children:_(this,"policy.logging.directories.snapshotted")}),dt(this,"logging.directories.snapshotted")]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Directory Ignored",help:"Log verbosity when a directory is ignored."}),Object(F.jsx)(ht,{children:_(this,"policy.logging.directories.ignored")}),dt(this,"logging.directories.ignored")]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"File Snapshotted",help:"Log verbosity when a file, symbolic link, etc. is snapshotted."}),Object(F.jsx)(ht,{children:_(this,"policy.logging.entries.snapshotted")}),dt(this,"logging.entries.snapshotted")]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"File Ignored",help:"Log verbosity when a file, symbolic link, etc. is ignored."}),Object(F.jsx)(ht,{children:_(this,"policy.logging.entries.ignored")}),dt(this,"logging.entries.ignored")]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Cache Hit",help:"Log verbosity when an cache is used instead of uploading the file."}),Object(F.jsx)(ht,{children:_(this,"policy.logging.entries.cacheHit")}),dt(this,"logging.entries.cacheHit")]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Cache Miss",help:"Log verbosity when an cache cannot be used and a file must be hashed."}),Object(F.jsx)(ht,{children:_(this,"policy.logging.entries.cacheHit")}),dt(this,"logging.entries.cacheMiss")]})]})]}),Object(F.jsxs)(ot.a.Item,{eventKey:"other",children:[Object(F.jsxs)(ot.a.Header,{children:[Object(F.jsx)(Y.a,{icon:Z.q}),"\xa0Other"]}),Object(F.jsxs)(ot.a.Body,{children:[Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"Disable Parent Policy Evaluation",help:"prevents any parent policies from affecting this directory and subdirectories"}),Object(F.jsx)(lt,{children:G(this,"","policy.noParent")})]}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(ct,{name:"JSON Representation",help:"This is the internal representation of a policy."}),Object(F.jsx)(ht,{children:Object(F.jsx)("pre",{className:"debug-json",children:JSON.stringify(this.state.policy,null,4)})})]})]})]})]}),!this.props.embedded&&Object(F.jsx)(x.a,{size:"sm",variant:"success",type:"submit",onClick:this.saveChanges,"data-testid":"button-save",disabled:this.state.saving,children:"Save Policy"}),!this.state.isNew&&!this.props.embedded&&Object(F.jsxs)(F.Fragment,{children:["\xa0",Object(F.jsx)(x.a,{size:"sm",variant:"danger",disabled:this.isGlobal()||this.state.saving,onClick:this.deletePolicy,children:"Delete Policy"})]}),this.state.saving&&Object(F.jsxs)(F.Fragment,{children:["\xa0",Object(F.jsx)($.a,{animation:"border",variant:"primary",size:"sm"})]})]})})}}]),s}(n.Component),mt=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(){var e;return Object(b.a)(this,s),(e=t.call(this)).state={isLoading:!0,error:null,showLog:!1},e.taskID=e.taskID.bind(Object(m.a)(e)),e.fetchTask=e.fetchTask.bind(Object(m.a)(e)),e.interval=window.setInterval((function(){return e.fetchTask(e.props)}),500),e}return Object(O.a)(s,[{key:"componentDidMount",value:function(){this.setState({isLoading:!0}),this.fetchTask(this.props)}},{key:"componentWillUnmount",value:function(){this.interval&&window.clearInterval(this.interval)}},{key:"taskID",value:function(e){return e.taskID||e.match.params.tid}},{key:"fetchTask",value:function(e){var t=this;l.a.get("/api/v1/tasks/"+this.taskID(e)).then((function(e){t.setState({task:e.data,isLoading:!1}),e.data.endTime&&(window.clearInterval(t.interval),t.interval=null)})).catch((function(e){he(e),t.setState({error:e,isLoading:!1})}))}},{key:"componentDidUpdate",value:function(e){e!==this.props&&this.fetchTask(this.props)}},{key:"taskStatusDescription",value:function(e){return"RUNNING"===e.status?Object(F.jsx)(F.Fragment,{children:Object(F.jsx)($.a,{animation:"border",variant:"primary",size:"sm"})}):"SUCCESS"===e.status?"Total":"CANCELED"===e.status?"(Canceled)":e.status}},{key:"render",value:function(){var e,t,s,n,i,a,r,o,c=this,l=this.state,h=l.task,d=l.isLoading,u=l.error;return u?Object(F.jsx)("p",{children:u.message}):d?Object(F.jsx)("p",{children:"Loading ..."}):Object(F.jsxs)(F.Fragment,{children:[h.counters&&Object(F.jsxs)(g.a.Text,{className:"estimateResults",children:[this.taskStatusDescription(h)," Bytes: ",Object(F.jsx)("b",{children:ie(null===(e=h.counters.Bytes)||void 0===e?void 0:e.value)})," (",Object(F.jsx)("b",{children:ie(null===(t=h.counters["Excluded Bytes"])||void 0===t?void 0:t.value)})," excluded) Files: ",Object(F.jsx)("b",{children:null===(s=h.counters.Files)||void 0===s?void 0:s.value})," (",Object(F.jsx)("b",{children:null===(n=h.counters["Excluded Files"])||void 0===n?void 0:n.value})," excluded) Directories: ",Object(F.jsx)("b",{children:null===(i=h.counters.Directories)||void 0===i?void 0:i.value})," (",Object(F.jsx)("b",{children:null===(a=h.counters["Excluded Directories"])||void 0===a?void 0:a.value})," excluded) Errors: ",Object(F.jsx)("b",{children:null===(r=h.counters.Errors)||void 0===r?void 0:r.value})," (",Object(F.jsx)("b",{children:null===(o=h.counters["Ignored Errors"])||void 0===o?void 0:o.value})," ignored)"]}),"RUNNING"===h.status&&Object(F.jsxs)(F.Fragment,{children:["\xa0",Object(F.jsxs)(x.a,{size:"sm",variant:"light",onClick:function(){return je(h.id)},children:[Object(F.jsx)(Y.a,{icon:Z.r,color:"red"})," Cancel "]})]}),this.state.showLog?Object(F.jsxs)(F.Fragment,{children:[Object(F.jsxs)(x.a,{size:"sm",variant:"light",onClick:function(){return c.setState({showLog:!1})},children:[Object(F.jsx)(Y.a,{icon:Z.g})," Hide Log"]}),Object(F.jsx)(it,{taskID:this.taskID(this.props)})]}):Object(F.jsxs)(x.a,{size:"sm",variant:"light",onClick:function(){return c.setState({showLog:!0})},children:[Object(F.jsx)(Y.a,{icon:Z.f})," Show Log"]})]})}}]),s}(n.Component),vt=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(){var e;return Object(b.a)(this,s),(e=t.call(this)).state={path:"",estimateTaskID:null,estimateTaskVisible:!1,lastEstimatedPath:"",policyEditorVisibleFor:"n/a",localUsername:null},e.policyEditorRef=i.a.createRef(),e.handleChange=N.bind(Object(m.a)(e)),e.estimate=e.estimate.bind(Object(m.a)(e)),e.snapshotNow=e.snapshotNow.bind(Object(m.a)(e)),e}return Object(O.a)(s,[{key:"componentDidMount",value:function(){var e=this;l.a.get("/api/v1/sources").then((function(t){e.setState({localUsername:t.data.localUsername,localHost:t.data.localHost})})).catch((function(e){he(e)}))}},{key:"componentDidUpdate",value:function(){var e=this;this.state.lastResolvedPath!==this.state.path&&l.a.post("/api/v1/paths/resolve",{path:this.state.path}).then((function(t){e.setState({lastResolvedPath:e.state.path,resolvedSource:t.data.source})})).catch((function(e){he(e)})),this.state.estimateTaskVisible&&this.state.lastEstimatedPath!==this.state.resolvedSource.path&&this.setState({estimateTaskVisible:!1})}},{key:"estimate",value:function(e){var t=this;if(e.preventDefault(),this.state.resolvedSource.path){var s=this.policyEditorRef.current;if(s)try{var n={root:this.state.resolvedSource.path,maxExamplesPerBucket:10,policyOverride:s.getAndValidatePolicy()};l.a.post("/api/v1/estimate",n).then((function(e){t.setState({lastEstimatedPath:t.state.resolvedSource.path,estimateTaskID:e.data.id,estimatingPath:e.data.description,estimateTaskVisible:!0,didEstimate:!1})})).catch((function(e){ve(e)}))}catch(e){ve(e)}}}},{key:"snapshotNow",value:function(e){var t=this;if(e.preventDefault(),this.state.resolvedSource.path){var s=this.policyEditorRef.current;if(s)try{l.a.post("/api/v1/sources",{path:this.state.resolvedSource.path,createSnapshot:!0,policy:s.getAndValidatePolicy()}).then((function(e){t.props.history.goBack()})).catch((function(e){ve(e),t.setState({error:e,isLoading:!1})}))}catch(e){ve(e)}}else alert("Must specify directory to snapshot.")}},{key:"render",value:function(){var e,t,s=this;return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsxs)(y.a,{children:[Object(F.jsx)(g.a.Group,{children:Object(F.jsx)(pe,{onClick:this.props.history.goBack})}),"\xa0\xa0\xa0",Object(F.jsx)("h4",{children:"New Snapshot"})]}),Object(F.jsx)("br",{}),Object(F.jsxs)(y.a,{children:[Object(F.jsx)(k.a,{children:Object(F.jsx)(g.a.Group,{children:Object(F.jsx)(fe,{onDirectorySelected:function(e){return s.setState({path:e})},autoFocus:!0,placeholder:"enter path to snapshot",name:"path",value:this.state.path,onChange:this.handleChange})})}),Object(F.jsxs)(k.a,{xs:"auto",children:[Object(F.jsx)(x.a,{size:"sm",disabled:!(null===(e=this.state.resolvedSource)||void 0===e?void 0:e.path),title:"Estimate",variant:"primary",onClick:this.estimate,children:"Estimate"}),"\xa0",Object(F.jsx)(x.a,{size:"sm",disabled:!(null===(t=this.state.resolvedSource)||void 0===t?void 0:t.path),title:"Snapshot Now",variant:"success",onClick:this.snapshotNow,children:"Snapshot Now"})]})]}),this.state.estimateTaskID&&this.state.estimateTaskVisible&&Object(F.jsx)(mt,{taskID:this.state.estimateTaskID,hideDescription:!0,showZeroCounters:!0}),Object(F.jsx)("br",{}),this.state.resolvedSource&&Object(F.jsx)(y.a,{children:Object(F.jsxs)(k.a,{xs:12,children:[Object(F.jsx)(g.a.Text,{children:this.state.resolvedSource?this.state.resolvedSource.path:this.state.path}),Object(F.jsx)(Ot,{ref:this.policyEditorRef,embedded:!0,host:this.state.resolvedSource.host,userName:this.state.resolvedSource.userName,path:this.state.resolvedSource.path})]})}),Object(F.jsx)(y.a,{children:Object(F.jsx)(k.a,{children:"\xa0"})}),Object(F.jsx)(xe,{command:"snapshot create ".concat(this.state.resolvedSource?this.state.resolvedSource.path:this.state.path)})]})}}]),s}(n.Component),ft=function(e){Object(v.a)(s,e);var t=Object(f.a)(s);function s(){var e;return Object(b.a)(this,s),(e=t.call(this)).editorRef=Object(n.createRef)(),e}return Object(O.a)(s,[{key:"render",value:function(){var e=ae(this.props.location.search),t=e.userName,s=e.host,n=e.path;return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsxs)("h4",{children:[Object(F.jsx)(pe,{onClick:this.props.history.goBack}),"\xa0\xa0",be(e)]}),Object(F.jsx)(Ot,{ref:this.editorRef,userName:t,host:s,path:n,close:this.props.history.goBack}),Object(F.jsx)(y.a,{children:Object(F.jsx)(k.a,{children:"\xa0"})}),Object(F.jsx)(y.a,{children:Object(F.jsx)(k.a,{xs:12,children:Object(F.jsx)(xe,{command:'policy set "'.concat(t,"@").concat(s,":").concat(n,'"')})})})]})}}]),s}(n.Component);var xt=function(){var e=Object(n.useState)(0),t=Object(o.a)(e,2),s=t[0],i=t[1];return function(e,t){var s=Object(n.useRef)();Object(n.useEffect)((function(){s.current=e}),[e]),Object(n.useEffect)((function(){if(null!==t){var e=setInterval((function(){s.current()}),t);return function(){return clearInterval(e)}}}),[t])}((function(){l.a.get("/api/v1/tasks-summary").then((function(e){i(e.data.RUNNING||0)})).catch((function(e){i(-1)}))}),1e3),Object(F.jsxs)(j.a,{children:[Object(F.jsxs)(u.a,{bg:"light",expand:"sm",children:[Object(F.jsx)(u.a.Brand,{href:"/",children:Object(F.jsx)("img",{src:Fe,className:"App-logo",alt:"logo"})}),Object(F.jsx)(u.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(F.jsx)(u.a.Collapse,{id:"basic-navbar-nav",children:Object(F.jsxs)(d.a,{className:"mr-auto",children:[Object(F.jsx)(j.c,{className:"nav-link",activeClassName:"active",to:"/snapshots",children:"Snapshots"}),Object(F.jsx)(j.c,{className:"nav-link",activeClassName:"active",to:"/policies",children:"Policies"}),Object(F.jsxs)(j.c,{className:"nav-link",activeClassName:"active",to:"/tasks",children:["Tasks ",Object(F.jsx)(F.Fragment,{children:s>0&&Object(F.jsxs)(F.Fragment,{children:["(",s,")"]})})]}),Object(F.jsx)(j.c,{className:"nav-link",activeClassName:"active",to:"/repo",children:"Repository"})]})})]}),Object(F.jsx)(h.a,{fluid:!0,children:Object(F.jsxs)(p.d,{children:[Object(F.jsx)(p.b,{path:"/snapshots/new",component:vt}),Object(F.jsx)(p.b,{path:"/snapshots/single-source/",component:Qe}),Object(F.jsx)(p.b,{path:"/snapshots/dir/:oid/restore",component:ge}),Object(F.jsx)(p.b,{path:"/snapshots/dir/:oid",component:Le}),Object(F.jsx)(p.b,{path:"/snapshots",component:st}),Object(F.jsx)(p.b,{path:"/policies/edit/",component:ft}),Object(F.jsx)(p.b,{path:"/policies",component:ze}),Object(F.jsx)(p.b,{path:"/tasks/:tid",component:at}),Object(F.jsx)(p.b,{path:"/tasks",component:rt}),Object(F.jsx)(p.b,{path:"/repo",component:Ye}),Object(F.jsx)(p.b,{exact:!0,path:"/",children:Object(F.jsx)(p.a,{to:"/snapshots"})})]})})]})};s(147);r.a.render(Object(F.jsx)(xt,{}),document.getElementById("root"))}},[[148,1,2]]]);
//# sourceMappingURL=main.1c0cddd1.chunk.js.map